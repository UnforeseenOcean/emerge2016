!function(e,t){"function"==typeof define&&define.amd?define([],t):e.BB=t()}(this,function(){var e,t,i;return function(o){function n(e,t){return b.call(e,t)}function r(e,t){var i,o,n,r,s,a,h,c,u,l,p,f=t&&t.split("/"),d=B.map,y=d&&d["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=e.split("/"),s=e.length-1,B.nodeIdCompat&&x.test(e[s])&&(e[s]=e[s].replace(x,"")),e=f.slice(0,f.length-1).concat(e),u=0;u<e.length;u+=1)if(p=e[u],"."===p)e.splice(u,1),u-=1;else if(".."===p){if(1===u&&(".."===e[2]||".."===e[0]))break;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((f||y)&&d){for(i=e.split("/"),u=i.length;u>0;u-=1){if(o=i.slice(0,u).join("/"),f)for(l=f.length;l>0;l-=1)if(n=d[f.slice(0,l).join("/")],n&&(n=n[o])){r=n,a=u;break}if(r)break;!h&&y&&y[o]&&(h=y[o],c=u)}!r&&h&&(r=h,a=c),r&&(i.splice(0,a,r),e=i.join("/"))}return e}function s(e,t){return function(){var i=v.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),f.apply(o,i.concat([e,t]))}}function a(e){return function(t){return r(t,e)}}function h(e){return function(t){g[e]=t}}function c(e){if(n(m,e)){var t=m[e];delete m[e],w[e]=!0,p.apply(o,t)}if(!n(g,e)&&!n(w,e))throw new Error("No "+e);return g[e]}function u(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function l(e){return function(){return B&&B.config&&B.config[e]||{}}}var p,f,d,y,g={},m={},B={},w={},b=Object.prototype.hasOwnProperty,v=[].slice,x=/\.js$/;d=function(e,t){var i,o=u(e),n=o[0];return e=o[1],n&&(n=r(n,t),i=c(n)),n?e=i&&i.normalize?i.normalize(e,a(t)):r(e,t):(e=r(e,t),o=u(e),n=o[0],e=o[1],n&&(i=c(n))),{f:n?n+"!"+e:e,n:e,pr:n,p:i}},y={require:function(e){return s(e)},exports:function(e){var t=g[e];return"undefined"!=typeof t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:l(e)}}},p=function(e,t,i,r){var a,u,l,p,f,B,b=[],v=typeof i;if(r=r||e,"undefined"===v||"function"===v){for(t=!t.length&&i.length?["require","exports","module"]:t,f=0;f<t.length;f+=1)if(p=d(t[f],r),u=p.f,"require"===u)b[f]=y.require(e);else if("exports"===u)b[f]=y.exports(e),B=!0;else if("module"===u)a=b[f]=y.module(e);else if(n(g,u)||n(m,u)||n(w,u))b[f]=c(u);else{if(!p.p)throw new Error(e+" missing "+u);p.p.load(p.n,s(r,!0),h(u),{}),b[f]=g[u]}l=i?i.apply(g[e],b):void 0,e&&(a&&a.exports!==o&&a.exports!==g[e]?g[e]=a.exports:l===o&&B||(g[e]=l))}else e&&(g[e]=i)},e=t=f=function(e,t,i,n,r){if("string"==typeof e)return y[e]?y[e](t):c(d(e,t).f);if(!e.splice){if(B=e,B.deps&&f(B.deps,B.callback),!t)return;t.splice?(e=t,t=i,i=null):e=o}return t=t||function(){},"function"==typeof i&&(i=n,n=r),n?p(o,e,t,i):setTimeout(function(){p(o,e,t,i)},4),f},f.config=function(e){return f(e)},e._defined=g,i=function(e,t,i){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(i=t,t=[]),n(g,e)||n(m,e)||(m[e]=[e,t,i])},i.amd={jQuery:!0}}(),i("../node_modules/almond/almond",function(){}),i("BB",[],function(){"use strict";function e(){}return e}),i("BB.Vector2",["./BB"],function(e){"use strict";return e.Vector2=function(e,t){this.x=e||0,this.y=t||0},e.Vector2.prototype={constructor:e.Vector2,set:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("BB.Vector2.setComponent: index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("BB.Vector2.getComponent: index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?this.addVectors(e,t):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},sub:function(e,t){return void 0!==t?this.subVectors(e,t):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t}else this.x=0,this.y=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this},clampScalar:function(){var t,i;return function(o,n){return void 0===t&&(t=new e.Vector2,i=new e.Vector2),t.set(o,o),i.set(n,n),this.clamp(t,i)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e),this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromAttribute:function(e,t,i){return void 0===i&&(i=0),t=t*e.itemSize+i,this.x=e.array[t],this.y=e.array[t+1],this},clone:function(){return new e.Vector2(this.x,this.y)}},e.Vector2}),i("BB.MathUtils",["./BB","./BB.Vector2"],function(e,t){"use strict";function i(e){return.5*(1-Math.cos(e*Math.PI))}e.Vector2=t,e.MathUtils=function(){},e.MathUtils.norm=function(e,t,i){if("number"!=typeof e)throw new Error("BB.MathUtils.norm: value is not a number type");if("number"!=typeof t)throw new Error("BB.MathUtils.norm: min is not a number type");if("number"!=typeof i)throw new Error("BB.MathUtils.norm: max is not a number type");return(e-t)/(i-t)},e.MathUtils.lerp=function(e,t,i){if("number"!=typeof e)throw new Error("BB.MathUtils.lerp: norm is not a number type");if("number"!=typeof t)throw new Error("BB.MathUtils.lerp: min is not a number type");if("number"!=typeof i)throw new Error("BB.MathUtils.lerp: max is not a number type");return(i-t)*e+t},e.MathUtils.clamp=function(e,t,i){if("number"!=typeof e)throw new Error("BB.MathUtils.clamp: norm is not a number type");if("number"!=typeof t)throw new Error("BB.MathUtils.clamp: min is not a number type");if("number"!=typeof i)throw new Error("BB.MathUtils.clamp: max is not a number type");return Math.max(t,Math.min(i,e))},e.MathUtils.map=function(e,t,i,o,n){if("number"!=typeof e)throw new Error("BB.MathUtils.map: value is not a number type");if("number"!=typeof t)throw new Error("BB.MathUtils.map: sourceMin is not a number type");if("number"!=typeof i)throw new Error("BB.MathUtils.map: sourceMax is not a number type");if("number"!=typeof o)throw new Error("BB.MathUtils.map: destMin is not a number type");if("number"!=typeof n)throw new Error("BB.MathUtils.map: destMax is not a number type");return this.lerp(this.norm(e,t,i),o,n)},e.MathUtils.dist=function(e,t,i,o){if("number"!=typeof e)throw new Error("BB.MathUtils.dist: p1x is not a number type");if("number"!=typeof t)throw new Error("BB.MathUtils.dist: p1y is not a number type");if("number"!=typeof i)throw new Error("BB.MathUtils.dist: p2x is not a number type");if("number"!=typeof o)throw new Error("BB.MathUtils.dist: p2y is not a number type");return Math.sqrt(Math.pow(i-e,2)+Math.pow(o-t,2))},e.MathUtils.angleBtw=function(e,t,i,o){if("number"!=typeof e)throw new Error("BB.MathUtils.angleBtwn: p1x is not a number type");if("number"!=typeof t)throw new Error("BB.MathUtils.angleBtwn: p1y is not a number type");if("number"!=typeof i)throw new Error("BB.MathUtils.angleBtwn: p2x is not a number type");if("number"!=typeof o)throw new Error("BB.MathUtils.angleBtwn: p2y is not a number type");return Math.atan2(i-e,o-t)},e.MathUtils.radToDeg=function(e){if("number"!=typeof e)throw new Error("BB.MathUtils.radToDegree: radians is not a number type");return e*(180/Math.PI)},e.MathUtils.degToRad=function(e){if("number"!=typeof e)throw new Error("BB.MathUtils.degToRad: degrees is not a number type");return e*(Math.PI/180)},e.MathUtils.polarToCartesian=function(e,t){if("number"!=typeof e||"number"!=typeof t)throw new Error("BB.MathUtils.polarToCartesian: invalid arguments, function expects two Number type parameters.");return[e*Math.cos(t),e*Math.sin(t)]},e.MathUtils.cartesianToPolar=function(e,t){if("number"!=typeof e||"number"!=typeof t)throw new Error("BB.MathUtils.cartesianToPolar: invalid arguments, function expects two Number type parameters.");return[Math.sqrt(e*e+t*t),Math.atan(t/e)]},e.MathUtils.randomInt=function(e,t){if(0===arguments.length)throw new Error("BB.MathUtils.cartesianToPolar: requires at least one argument");return Math.floor(1===arguments.length?0+Math.random()*(e-0+1):e+Math.random()*(t-e+1))},e.MathUtils.randomFloat=function(e,t){if(0===arguments.length)throw new Error("BB.MathUtils.cartesianToPolar: requires at least one argument");return 1===arguments.length?0+Math.random()*(e-0):e+Math.random()*(t-e)};var o=null,n=4,r=1<<n,s=8,a=1<<s,h=4095,c=4,u=.5;return e.MathUtils.noise=function(e,t,l){if(t=t||0,l=l||0,null===o){o=new Array(h+1);for(var p=0;h+1>p;p++)o[p]=Math.random()}0>e&&(e=-e),0>t&&(t=-t),0>l&&(l=-l);for(var f,d,y,g,m,B=Math.floor(e),w=Math.floor(t),b=Math.floor(l),v=e-B,x=t-w,M=l-b,A=0,_=.5,D=0;c>D;D++){var E=B+(w<<n)+(b<<s);f=i(v),d=i(x),y=o[E&h],y+=f*(o[E+1&h]-y),g=o[E+r&h],g+=f*(o[E+r+1&h]-g),y+=d*(g-y),E+=a,g=o[E&h],g+=f*(o[E+1&h]-g),m=o[E+r&h],m+=f*(o[E+r+1&h]-m),g+=d*(m-g),y+=i(M)*(g-y),A+=y*_,_*=u,B<<=1,v*=2,w<<=1,x*=2,b<<=1,M*=2,v>=1&&(B++,v--),x>=1&&(w++,x--),M>=1&&(b++,M--)}return A},e.MathUtils}),i("BB.Detect",["./BB"],function(e){"use strict";return e.Detect=function(){},Object.defineProperty(e.Detect,"browserInfo",{get:function(){var e,t=navigator.userAgent,i=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(i[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE "+(e[1]||"")):"Chrome"===i[1]&&(e=t.match(/\b(OPR|Edge)\/(\d+)/),null!==e)?e.slice(1).join(" ").replace("OPR","Opera"):(i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(e=t.match(/version\/(\d+)/i))&&i.splice(1,1,e[1]),{name:i[0],version:i[1]})},set:function(e){throw new Error("BB.Detect.browserInfo: is read only")}}),Object.defineProperty(e.Detect,"isMobile",{get:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)?!0:!1},set:function(e){throw new Error("BB.Detect.browserInfo: is read only")}}),Object.defineProperty(e.Detect,"hasWebGL",{get:function(){return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")},set:function(e){throw new Error("BB.Detect.browserInfo: is read only")}}),e.Detect}),i("BB.Color",["./BB"],function(e){"use strict";return e.Color=function(e,t,i,o){if("undefined"==typeof e)this._r=228;else{if("number"!=typeof e||0>e||e>255)throw new Error("BB.Color: red parameter neeeds to be a NUMBER between 0 - 255");this._r=e}if("undefined"==typeof t)this._g=4;else{if("number"!=typeof t||0>t||t>255)throw new Error("BB.Color: green parameter neeeds to be a NUMBER between 0 - 255");this._g=t}if("undefined"==typeof i)this._b=119;else{if("number"!=typeof i||0>i||i>255)throw new Error("BB.Color: blue parameter neeeds to be a NUMBER between 0 - 255");this._b=i}if("undefined"==typeof o)this._a=255;else{if(0>o||o>255)throw new Error("BB.Color: alpha parameter neeeds to be a NUMBER between 0 - 255");this._a=o}this.rgb2hsv(),this.schemes={monochromatic:[],analogous:[],complementary:[],splitcomplementary:[],triadic:[],tetradic:[],random:[]}},Object.defineProperty(e.Color.prototype,"r",{get:function(){return this._r},set:function(e){if("number"!=typeof e||0>e||e>255)throw new Error("BB.Color: red parameter neeeds to be a NUMBER between 0 - 255");this._r=e,this.rgb2hsv()}}),Object.defineProperty(e.Color.prototype,"g",{get:function(){return this._g},set:function(e){if("number"!=typeof e||0>e||e>255)throw new Error("BB.Color: green parameter neeeds to be a NUMBER between 0 - 255");this._g=e,this.rgb2hsv()}}),Object.defineProperty(e.Color.prototype,"b",{get:function(){return this._b},set:function(e){if("number"!=typeof e||0>e||e>255)throw new Error("BB.Color: blue parameter neeeds to be a NUMBER between 0 - 255");this._b=e,this.rgb2hsv()}}),Object.defineProperty(e.Color.prototype,"a",{get:function(){return this._a},set:function(e){if("number"!=typeof e||0>e||e>255)throw new Error("BB.Color: alpha parameter neeeds to be a NUMBER between 0 - 255");this._a=e,this.rgb2hsv()}}),Object.defineProperty(e.Color.prototype,"h",{get:function(){return this._h},set:function(e){if("number"!=typeof e||0>e||e>359)throw new Error("BB.Color: hue parameter neeeds to be a NUMBER between 0 - 359");this._h=e,this.hsv2rgb()}}),Object.defineProperty(e.Color.prototype,"s",{get:function(){return this._s},set:function(e){if("number"!=typeof e||0>e||e>100)throw new Error("BB.Color: saturation parameter neeeds to be a NUMBER between 0 - 100");this._s=e,this.hsv2rgb()}}),Object.defineProperty(e.Color.prototype,"v",{get:function(){return this._v},set:function(e){if("number"!=typeof e||0>e||e>100)throw new Error("BB.Color: brightness/lightness parameter neeeds to be a NUMBER between 0 - 100");this._v=e,this.hsv2rgb()}}),Object.defineProperty(e.Color.prototype,"rgb",{get:function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},set:function(e){if("string"!=typeof e)throw new Error("BB.Color: rgb parameter expects an rgb(...) string");if(0!==e.indexOf("rgb("))throw new Error("BB.Color: expecting string staring with 'rgb(' ");if(")"!==e[e.length-1])throw new Error("BB.Color: expecting string ending with ')' ");if(e=e.substr(4,e.length-5),e=e.split(","),e.length<3)throw new Error("BB.Color: rgb(...) requires 3 properties");if(e[0]=parseInt(e[0]),e[1]=parseInt(e[1]),e[2]=parseInt(e[2]),e[0]<0||e[0]>255)throw new Error("BB.Color: red value must be between 0 - 255 ");if(e[1]<0||e[1]>255)throw new Error("BB.Color: green value must be between 0 - 255 ");if(e[2]<0||e[2]>255)throw new Error("BB.Color: blue value must be between 0 - 255 ");this.r=e[0],this.g=e[1],this.b=e[2]}}),Object.defineProperty(e.Color.prototype,"rgba",{get:function(){return"rgba("+this.r+", "+this.g+", "+this.b+","+Math.floor(this.a/255*100)/100+")"},set:function(e){if("string"!=typeof e)throw new Error("BB.Color: rgba parameter expects an rgba(...) string");if(0!==e.indexOf("rgba("))throw new Error("BB.Color: expecting string staring with 'rgba(' ");if(")"!==e[e.length-1])throw new Error("BB.Color: expecting string ending with ')' ");if(e=e.substr(5,e.length-6),e=e.split(","),e.length<4)throw new Error("BB.Color: rgba(...) requires 4 properties");if(e[0]=parseInt(e[0]),e[1]=parseInt(e[1]),e[2]=parseInt(e[2]),e[3]=parseFloat(e[3]),e[0]<0||e[0]>255)throw new Error("BB.Color: red value must be between 0 - 255 ");if(e[1]<0||e[1]>255)throw new Error("BB.Color: green value must be between 0 - 255 ");if(e[2]<0||e[2]>255)throw new Error("BB.Color: blue value must be between 0 - 255 ");if(e[3]<0||e[3]>1)throw new Error("BB.Color: alpha value must be between 0.0 - 1.0 ");this.r=e[0],this.g=e[1],this.b=e[2],this.a=Math.floor(255*e[3])}}),Object.defineProperty(e.Color.prototype,"hex",{get:function(){return"#"+(this.r<<16|this.g<<8|this.b).toString(16)},set:function(e){if("string"!=typeof e)throw new Error("BB.Color: hex parameter expects a # string");if(0!==e.indexOf("#"))throw new Error("BB.Color: expecting string staring with '#' ");if(7!==e.length&&4!==e.length)throw new Error("BB.Color: hex string is too long or short ");var t;7===e.length?(e=e.substr(1,e.length-1),t=[e.substr(0,e.length-4),e.substr(2,e.length-4),e.substr(4,e.length-4)],this.r=parseInt("0x"+t[0]),this.g=parseInt("0x"+t[1]),this.b=parseInt("0x"+t[2])):(e=e.substr(1,e.length-1),t=[e.substr(0,e.length-2),e.substr(1,e.length-2),e.substr(2,e.length-2)],this.r=parseInt("0x"+t[0]+t[0]),this.g=parseInt("0x"+t[1]+t[1]),this.b=parseInt("0x"+t[2]+t[2]))}}),e.Color.prototype.copy=function(t){if("undefined"==typeof t||!(t instanceof e.Color))throw new Error("BB.Color.copy: color parameter is not an instance of BB.Color");return this.setRGBA(t.r,t.g,t.b,t.a),this},e.Color.prototype.clone=function(){var t=new e.Color;return t.copy(this),t},e.Color.prototype.setRGBA=function(e,t,i,o){if("number"!=typeof e||0>e||e>255)throw new Error("BB.Color: red parameter neeeds to be a NUMBER between 0 - 255");if(this.r=e,"number"!=typeof t||0>t||t>255)throw new Error("BB.Color: green parameter neeeds to be a NUMBER between 0 - 255");if(this.g=t,"number"!=typeof i||0>i||i>255)throw new Error("BB.Color: blue parameter neeeds to be a NUMBER between 0 - 255");if(this.b=i,"number"!=typeof o||0>o||o>255)throw new Error("BB.Color: alpha parameter neeeds to be a NUMBER between 0 - 255");return this.a=o,this.rgb2hsv(),this},e.Color.prototype.setHSVA=function(e,t,i,o){if("number"!=typeof e||0>e||e>359)throw new Error("BB.Color: hue parameter neeeds to be a NUMBER between 0 - 359");if(this.h=e,"number"!=typeof t||0>t||t>100)throw new Error("BB.Color: saturation parameter neeeds to be a NUMBER between 0 - 100");if(this.s=t,"number"!=typeof i||0>i||i>100)throw new Error("BB.Color: value parameter neeeds to be a NUMBER between 0 - 100");if(this.v=i,"number"!=typeof o||0>o||o>255)throw new Error("BB.Color: alpha parameter neeeds to be a NUMBER between 0 - 255");return this.a=o,this.hsv2rgb(),this},e.Color.prototype.isEqual=function(t,i){if(!(t&&t instanceof e.Color))throw new Error("BB.Color.isEqual: color parameter is not an instance of BB.Color");return i?this.r===t.r&&this.g===t.g&&this.b===t.b:this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},e.Color.prototype.min3=function(e,t,i){return t>e?i>e?e:i:i>t?t:i},e.Color.prototype.max3=function(e,t,i){return e>t?e>i?e:i:t>i?t:i},e.Color.prototype.rgb2hsv=function(t,i,o){var n;n="undefined"==typeof t?this:t instanceof e.Color?t:{r:t,g:i,b:o};var r={},s=Math.max(n.r,Math.max(n.g,n.b)),a=s-Math.min(n.r,Math.min(n.g,n.b));return r.s=0===s?0:100*a/s,0===r.s?r.h=0:n.r==s?r.h=60*(n.g-n.b)/a:n.g==s?r.h=120+60*(n.b-n.r)/a:n.b==s&&(r.h=240+60*(n.r-n.g)/a),r.h<0&&(r.h+=360),r.h=Math.round(r.h),r.s=Math.round(r.s),r.v=Math.round(100*s/255),"undefined"==typeof t&&(this._h=r.h,this._s=r.s,this._v=r.v),r},e.Color.prototype.hsv2rgb=function(t,i,o){var n,r;"undefined"==typeof t?(n={r:this.r,g:this.g,b:this.b},r={h:this.h,s:this.s,v:this.v}):(n={},r=t instanceof e.Color?t.clone():{h:t,s:i,v:o}),r.h/=60,r.s/=100,r.v/=100;var s=Math.floor(r.h),a=r.h-s,h=r.v*(1-r.s),c=r.v*(1-r.s*a),u=r.v*(1-r.s*(1-a));switch(s){case 0:n.r=r.v,n.g=u,n.b=h;break;case 1:n.r=c,n.g=r.v,n.b=h;break;case 2:n.r=h,n.g=r.v,n.b=u;break;case 3:n.r=h,n.g=c,n.b=r.v;break;case 4:n.r=u,n.g=h,n.b=r.v;break;default:n.r=r.v,n.g=h,n.b=c}return n.r=Math.round(255*n.r),n.g=Math.round(255*n.g),n.b=Math.round(255*n.b),0===arguments.length&&(this._r=n.r,this._g=n.g,this._b=n.b),n},e.Color.prototype.shift=function(e,t){var i;for(i="undefined"==typeof t?this.h:t,i+=e;i>=360;)i-=360;for(;0>i;)i+=360;return"undefined"==typeof t?(this.h=i,this):i},e.Color.prototype.tint=function(t,i){var o={},n=t;return o.r=Math.round(this.r+(255-this.r)*n),o.g=Math.round(this.g+(255-this.g)*n),o.b=Math.round(this.b+(255-this.b)*n),o.a=this.a,"undefined"!=typeof i&&i===!0?new e.Color(o.r,o.g,o.b,o.a):(this.setRGBA(o.r,o.g,o.b,o.a),this)},e.Color.prototype.shade=function(t,i){var o={},n=t;return o.r=Math.round(this.r*n),o.g=Math.round(this.g*n),o.b=Math.round(this.b*n),o.a=this.a,"undefined"!=typeof i&&i===!0?new e.Color(o.r,o.g,o.b,o.a):(this.setRGBA(o.r,o.g,o.b,o.a),this)},e.Color.prototype.createScheme=function(e,t){if(!(e in this.schemes))throw new Error("BB.Color.createScheme: '"+e+"' is not a valid scheme name, choose from: "+Object.keys(this.schemes));if("object"==typeof t||"undefined"==typeof t){if("undefined"==typeof t&&(t={}),"undefined"==typeof t.angle&&(t.angle="tetradic"==e?40:30),"monochromatic"==e){if("undefined"==typeof t.tint)t.tint=[.4,.8];else if(!(t.tint instanceof Array))throw new Error("BB.Color.createScheme: tint should be an Array of floats between 0.0-1.0");if("undefined"==typeof t.shade)t.shade=[.3,.6];else if(!(t.shade instanceof Array))throw new Error("BB.Color.createScheme: shade should be an Array of floats between 0.0-1.0")}"random"==e&&"undefined"==typeof t.count&&(t.count=5)}if("object"!=typeof t)throw new Error("BB.Color.createScheme: config parameter should be an Object");this.schemes[e]=[];var i;switch(e){case"analogous":i=[t.angle,0-t.angle];break;case"complementary":i=[180];break;case"splitcomplementary":i=[180-t.angle,180+t.angle];break;case"triadic":i=[240,120];break;case"tetradic":i=[180,-t.angle,-t.angle+180]}var o=["analogous","complementary","splitcomplementary","triadic","tetradic"],n=["analogous","splitcomplementary","triadic","tetradic"],r=["tetradic"];"monochromatic"==e&&this._schemeVarient(e,t),o.indexOf(e)>=0&&this._schemeVarient(e,t,i[0]),n.indexOf(e)>=0&&this._schemeVarient(e,t,i[1]),r.indexOf(e)>=0&&this._schemeVarient(e,t,i[2]),"random"==e&&this._randomVarients(e,t)},e.Color.prototype._schemeVarient=function(t,i,o){var n,r,s;if("monochromatic"==t?n={r:this.r,g:this.g,b:this.b}:(n={r:this.r,g:this.g,b:this.b},r=this.rgb2hsv(n.r,n.g,n.b),r.h=this.shift(r.h,o),n=this.hsv2rgb(r.h,r.s,r.v)),s=new e.Color(n.r,n.g,n.b),"undefined"!=typeof i.tint){i.tint.sort(function(e,t){return t-e});for(var a=0;a<i.tint.length;a++){var h=s.tint(i.tint[a],!0);this.schemes[t].push(h)}}var c=s.clone();if(this.schemes[t].push(c),"undefined"!=typeof i.shade){i.shade.sort(function(e,t){return t-e});for(var u=0;u<i.shade.length;u++){var l=s.shade(i.shade[u],!0);this.schemes[t].push(l)}}},e.Color.prototype._randomVarients=function(t,i){"undefined"==typeof i.count&&(i.count=5);for(var o=0;o<i.count;o++){var n,r="undefined"==typeof i.hue?Math.floor(360*Math.random()):i.hue,s="undefined"==typeof i.saturation?Math.floor(100*Math.random()):i.saturation,a="undefined"==typeof i.value?Math.floor(100*Math.random()):i.value;n="undefined"!=typeof i.alpha?"random"==i.alpha?Math.floor(255*Math.random()):i.alpha:255;var h=this.hsv2rgb(r,s,a);h.a=n;var c=new e.Color(h.r,h.g,h.b,h.a);this.schemes[t].push(c)}},e.Color}),i("BB.MouseInput",["./BB"],function(e){"use strict";return e.MouseInput=function(t){function i(e){var t=o.canvasElem.getBoundingClientRect();return{x:Math.round((e.clientX-t.left)/(t.right-t.left)*o.canvasElem.width),y:Math.round((e.clientY-t.top)/(t.bottom-t.top)*o.canvasElem.height)}}if("undefined"==typeof t||!(t instanceof HTMLCanvasElement))throw new Error("BB.MouseInput: An HTML5 canvas object must be supplied as a first parameter.");var o=this,n=null;this.x=0,this.y=0,this.clickX=0,this.clickY=0,this.moveDebounce=150,this._isMoving=!1,this._isDown=!1,this.canvasElem=t,this.canvasElem.addEventListener("mousemove",function(e){var t=i(e);o.x=t.x,o.y=t.y,!o.isMoving&&o.hasOwnProperty("_moveStartCallback")&&"function"==typeof o._moveStartCallback&&o._moveStartCallback(o.x,o.y),o._isMoving=!0,clearTimeout(n),n=setTimeout(function(){o.isMoving&&o.hasOwnProperty("_moveStopCallback")&&"function"==typeof o._moveStartCallback&&(o._isMoving=!1,o._moveStopCallback(o.x,o.y))},o.moveDebounce)}),this.canvasElem.addEventListener("mousedown",function(t){t.button===e.MouseInput.LEFT_BUTTON&&(o._isDown=!0,o.hasOwnProperty("_activeStartCallback")&&"function"==typeof o._activeStartCallback&&o._activeStartCallback(o.x,o.y))}),this.canvasElem.addEventListener("mouseup",function(t){t.button===e.MouseInput.LEFT_BUTTON&&(o._isDown=!1,o.hasOwnProperty("_activeStopCallback")&&"function"==typeof o._activeStopCallback&&o._activeStopCallback(o.x,o.y))}),this.canvasElem.addEventListener("click",function(e){var t=i(e);o.clickX=t.x,o.clickY=t.y}),this.canvasElem.addEventListener("mouseleave",function(){o._isDown&&o.hasOwnProperty("_activeStopCallback")&&"function"==typeof o._activeStopCallback&&o._activeStopCallback(o.x,o.y),o.isMoving&&o.hasOwnProperty("_moveStopCallback")&&"function"==typeof o._moveStopCallback&&o._moveStopCallback(o.x,o.y),o._isMoving=!1,o._isDown=!1})},e.MouseInput.LEFT_BUTTON=0,e.MouseInput.SCROLL_BUTTON=1,e.MouseInput.RIGHT_BUTTON=2,Object.defineProperty(e.MouseInput.prototype,"isMoving",{get:function(){return this._isMoving},set:function(e){throw new Error("BB.MouseInput.isMoving (setter): BB.MouseInput.isMoving is a read-only property.")}}),Object.defineProperty(e.MouseInput.prototype,"isDown",{get:function(){return this._isDown},set:function(e){throw new Error("BB.MouseInput.isDown (setter): BB.MouseInput.isDown is a read-only property.")}}),e.MouseInput.prototype.update=function(){this.isMoving&&this.hasOwnProperty("_moveCallback")&&"function"==typeof this._moveCallback&&this._moveCallback(this.x,this.y)},e.MouseInput}),i("BB.Pointer",["./BB","./BB.MouseInput"],function(e,t){"use strict";function i(){this.controllerModule instanceof e.MouseInput&&(this.controllerModule._activeStartCallback=this._activeStartCallback,this.controllerModule._activeStopCallback=this._activeStopCallback,this.controllerModule._moveStartCallback=this._moveStartCallback,this.controllerModule._moveStopCallback=this._moveStopCallback,this.controllerModule._moveCallback=this._moveCallback)}return e.MouseInput=t,e.Pointer=function(t){if("undefined"==typeof t)throw new Error("BB.Pointer: controllerModule parameter is missing from the BB.Pointer constructor.");if(!(t instanceof e.MouseInput))throw this.controllerModule=null,new Error("BB.Pointer.update: controllerModule is not a supported object type.");this.controllerModule=t,this.x=null,this.y=null,this.isMoving=!1,this.isDown=!1,this.hasSelectionInterface=!1,this._activeStartCallback=null,this._activeStopCallback=null,this._moveStartCallback=null,this._moveStopCallback=null,this._moveCallback=null},Object.defineProperty(e.Pointer.prototype,"controllerModule",{get:function(){return this._controllerModule},set:function(e){this._controllerModule=e,i.call(this)}}),e.Pointer.prototype.update=function(){this.controllerModule instanceof e.MouseInput&&(this.x=this.controllerModule.x,this.y=this.controllerModule.y,this.isMoving=this.controllerModule.isMoving,this.isDown=this.controllerModule.isDown,this.hasSelectionInterface=!1)},e.Pointer.prototype.on=function(e,t){if("activestart"==e)this._activeStartCallback=t;else if("activestop"==e)this._activeStopCallback=t;else if("movestart"==e)this._moveStartCallback=t;else if("movestop"==e)this._moveStopCallback=t;else{if("move"!=e)throw new Error("BB.Pointer.on: eventName is not a supported event.");this._moveCallback=t}if(null===this._controllerModule)throw new Error("BB.Pointer.on: pointer has no controller module. You must first call BB.Pointer.update() to assign this pointer a controller module.");i.call(this)},e.Pointer}),i("BB.BrushManager2D",["./BB","BB.Pointer"],function(e,t){"use strict";return e.Pointer=t,e.BrushManager2D=function(e){var t=this;if("undefined"==typeof e||!(e instanceof HTMLCanvasElement))throw new Error("BB.BrushManager2D: An HTML5 canvas object must be supplied as a first parameter.");if("absolute"!==window.getComputedStyle(e).getPropertyValue("position"))throw new Error("BB.BrushManager2D: the HTML5 canvas passed into the BB.BrushManager2D constructor must be absolutely positioned. Sorry ;).");this._parentCanvas=e,this._parentContext=e.getContext("2d"),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.secondaryCanvas=document.createElement("canvas"),this.secondaryContext=this.secondaryCanvas.getContext("2d"),this._parentCanvas.parentNode.insertBefore(this.secondaryCanvas,this._parentCanvas.nextSibling),this.updateCanvasPosition(),this._numUndos=5,this._history=[],this._purgatory=[],this._fboImage=new Image,this._fboImage.onload=function(){t.secondaryContext.clearRect(0,0,t.canvas.width,t.canvas.height),t.secondaryCanvas.style.display=t._parentCanvas.style.display,t._fboImageLoadWaiting=!1},this._fboImageTemp=null,this._fboImage.onerror=function(e){console.log("BB.BrushManager2D: src failed to load: "+e.target.src)},this._secondaryFboImage=new Image,this._secondaryFboImage.onload=function(){t.context.clearRect(0,0,t.canvas.width,t.canvas.height),t.context.drawImage(t._fboImage,0,0),t.context.drawImage(t._secondaryFboImage,0,0),t._history.length===t.numUndos+1&&t._history.shift();var e=t.canvas.toDataURL();t._history.push(e),t._fboImageTemp=t._fboImage.cloneNode(!0),t._fboImageTemp.onload=function(){},t._fboImage.src=e,t.secondaryCanvas.style.display="none",t._parentContext.drawImage(t._secondaryFboImage,0,0),t._fboImageLoadWaiting=!0},this._pointers=[],this._pointerStates=[],this._needsUndo=!1,this._needsRedo=!1,this._somePointersDown=!1,this._fboImageLoadWaiting=!1,this._history.push(this.canvas.toDataURL())},Object.defineProperty(e.BrushManager2D.prototype,"numUndos",{get:function(){return this._numUndos},set:function(e){this._numUndos=e,this._numUndos<this._history.length-1&&this._history.splice(0,this._history.length-this._numUndos-1)}}),e.BrushManager2D.prototype.trackPointers=function(t){if(!(t instanceof Array))throw new Error("BB.BrushManager2D.trackPointers: pointers parameter must be an array of pointers.");for(var i=0;i<t.length;i++){var o=t[i];if(!(o instanceof e.Pointer))throw new Error("BB.BrushManager2D.trackPointers: pointers["+i+"] is not an instance of BB.Pointer.");this._pointers.push(o),this._pointerStates.push(o.isDown)}},e.BrushManager2D.prototype.untrackPointers=function(){this._pointers=[],this._pointerStates=[]},e.BrushManager2D.prototype.untrackPointerAtIndex=function(e){if("undefined"==typeof this._pointers[e])throw new Error("BB.BrushManager2D.untrackPointerAtIndex: Invalid pointer index "+e+". there is no pointer at that index.");this._pointers.splice(e,1),this._pointerStates.splice(e,1)},e.BrushManager2D.prototype.hasPointers=function(){return this._pointers.length>0},e.BrushManager2D.prototype.hasUndo=function(){return this._history.length>1},e.BrushManager2D.prototype.hasRedo=function(){return this._purgatory.length>0},e.BrushManager2D.prototype.update=function(){if(!this.hasPointers())throw new Error("BB.BrushManager2D.update: You must add at least one pointer to the brush manager with BB.BrushManager2D.addPointers(...)");var e=this._pointerStates.some(function(e){return e===!0});this._somePointersDown&&!e&&(this._secondaryFboImage.src=this.secondaryCanvas.toDataURL());for(var t=0;t<this._pointers.length;t++)this._pointerStates[t]=this._pointers[t].isDown;this._somePointersDown=e;var i;this._needsUndo?(this._purgatory.length==this.numUndos+1&&this._purgatory.shift(),this._purgatory.push(this._history.pop()),this._fboImage.src=this._history[this._history.length-1],this._needsUndo=!1):this._needsRedo?this._purgatory.length>0&&(i=this._purgatory.pop(),this._fboImage.src=i,this._history.push(i),this._needsRedo=!1):this._somePointersDown&&this._purgatory.length>0&&(this._purgatory=[])},e.BrushManager2D.prototype.draw=function(e){
if("undefined"==typeof e)e=this._parentContext;else if(!(e instanceof CanvasRenderingContext2D))throw new Error("BB.BrushManager2D.draw: context is not an instance of CanvasRenderingContext2D");this._fboImage.complete?e.drawImage(this._fboImage,0,0):null!==this._fboImageTemp&&(e.drawImage(this._fboImageTemp,0,0),this._fboImageLoadWaiting&&e.drawImage(this._secondaryFboImage,0,0))},e.BrushManager2D.prototype.undo=function(){this._history.length>1&&(this._needsUndo=!0)},e.BrushManager2D.prototype.redo=function(){this._history.length>0&&(this._needsRedo=!0)},e.BrushManager2D.prototype.updateCanvasPosition=function(){this.canvas.width=this._parentCanvas.width,this.canvas.height=this._parentCanvas.height,this.secondaryCanvas.width=this.canvas.width,this.secondaryCanvas.height=this.canvas.height;var e=window.getComputedStyle(this._parentCanvas);this.secondaryCanvas.style.position="absolute",this.secondaryCanvas.style.pointerEvents="none",this.secondaryCanvas.style.top=e.getPropertyValue("top"),this.secondaryCanvas.style.right=e.getPropertyValue("right"),this.secondaryCanvas.style.bottom=e.getPropertyValue("bottom"),this.secondaryCanvas.style.left=e.getPropertyValue("left"),this.secondaryCanvas.style.margin=e.getPropertyValue("margin"),this.secondaryCanvas.style.border=e.getPropertyValue("border"),this.secondaryCanvas.style.padding=e.getPropertyValue("padding");var t=e.getPropertyValue("z-index");if(isNaN(t))throw t=0,this.secondaryCanvas.style.zIndex=t+1,new Error('BB.BrushManager2D: the HTML5 canvas passed into the BB.BrushManager2D constructor should have a z-index property value that is numeric. Currently the value is "'+t+'".');t=parseInt(t),this.secondaryCanvas.style.zIndex=t+1},e.BrushManager2D}),i("BB.BaseBrush2D",["./BB","./BB.BrushManager2D","./BB.Color"],function(e,t,i){"use strict";return e.BaseBrush2D=t,e.Color=i,e.BaseBrush2D=function(t){this.x=t&&t.x&&"number"==typeof t.x?t.x:0,this.y=t&&t.y&&"number"==typeof t.y?t.y:0,this.width=t&&t.width&&"number"==typeof t.width?t.width:10,this.height=t&&t.height&&"number"==typeof t.height?t.height:10,this.rotation=t&&t.rotation&&"number"==typeof t.rotation?t.rotation:0,this.color=t&&t.color&&t.color instanceof e.Color?t.color:null,this.hidden=t&&t.hidden&&"boolean"==typeof hidden?t.hidden:!1,this.type="base",this.manager=t&&t.manager&&t.manager instanceof e.BrushManager2D?t.manager:null},e.BaseBrush2D.prototype.update=function(e){if(void 0===e)throw new Error("BB.BaseBrush.update: missing controllerModule parameter");if(void 0===e.x||"number"!=typeof e.x)throw new Error("BB.BaseBrush.update: controllerModule parameter does not have a valid x parameter");if(this.x=e.x,void 0===e.y||"number"!=typeof e.y)throw new Error("BB.BaseBrush.update: controllerModule parameter does not have a valid y parameter");this.y=e.y},e.BaseBrush2D.prototype.draw=function(t){if(!t)throw new Error("BB.BaseBrush.draw: Invalid context parameter");var i=t;return this.manager instanceof e.BrushManager2D&&(i=this.manager.secondaryContext),i},e.BaseBrush2D.prototype.scale=function(e){if("number"!=typeof e)throw new Error("BB.BaseBrush2D.scale: scale is not a number type");this.width*=e,this.height*=e},e.BaseBrush2D}),i("BB.ImageBrush2D",["./BB","./BB.BaseBrush2D","./BB.Color","./BB.MathUtils"],function(e,t,i,o){"use strict";e.BaseBrush2D=t,e.Color=i,e.MathUtils=o;var n=!1,r=!1;return e.ImageBrush2D=function(t){if(e.BaseBrush2D.call(this,t),this.type="image",this.variant=null,this._image=null,this._lastVariant=null,this._lastColor=new e.Color,this._src=null,this.variants=["star","wave","heart","bolt","balls","drips","flames","grid","cube","circles","shield","locking","seal","circleslash"],t){if(t.src&&t.variant)throw new Error("BB.ImageBrush2D: The config.src and config.variant properties are mutually exlusiveand cannot both be included in the same config object.");t.src&&"string"==typeof t.src&&(this.src=t.src),t.variant&&"string"==typeof t.variant&&-1!==this.variants.indexOf(t.variant)&&(this.variant=t.variant)}},e.ImageBrush2D.prototype=Object.create(e.BaseBrush2D.prototype),e.ImageBrush2D.prototype.constructor=e.ImageBrush2D,Object.defineProperty(e.ImageBrush2D.prototype,"src",{get:function(){return this._src},set:function(e){this._src=e,this.variant=null,n=!1,this._image=new Image,this._image.src=this.src,this._image.onload=function(){n=!0},r=!0}}),e.ImageBrush2D.prototype.update=function(t){e.BaseBrush2D.prototype.update.call(this,t),t.hasOwnProperty("isDown")&&(this.hidden=t.isDown===!1)},e.ImageBrush2D.prototype.draw=function(t){function i(){var t,i,n,r;switch(o.color&&o.color instanceof e.Color?(t=o.color.r,i=o.color.g,n=o.color.b,r=o.color.a/255):(t=255,i=255,n=255,r=1),o.variant){case"star":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M143.169,166.502L100,135.139l-43.169,31.363l16.489-50.746L30.152,84.391h53.359L100,33.644l16.489,50.748h53.358 l-43.168,31.365L143.169,166.502z M100,127.723l31.756,23.072l-12.13-37.332l31.757-23.072H112.13L100,53.06L87.87,90.391H48.618 l31.756,23.072l-12.13,37.332L100,127.723z"/></svg>';case"wave":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><g><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M163.888,97.971c-5.43-5.354-11.042-10.887-22.235-10.887c-11.195,0-16.806,5.533-22.234,10.887 c-5.101,5.027-9.918,9.777-19.685,9.777c-9.766,0-14.581-4.75-19.684-9.777c-5.427-5.354-11.039-10.887-22.233-10.887 c-11.193,0-16.806,5.533-22.233,10.887c-5.1,5.027-9.919,9.777-19.684,9.777c-0.13,0-0.25-0.01-0.379-0.012v5.169 c0.129,0.002,0.249,0.012,0.379,0.012c11.192,0,16.806-5.536,22.233-10.887c5.101-5.028,9.917-9.781,19.684-9.781 c9.766,0,14.584,4.753,19.685,9.781c5.427,5.351,11.04,10.887,22.232,10.887c11.194,0,16.807-5.536,22.233-10.887 c5.102-5.028,9.919-9.781,19.686-9.781c9.766,0,14.584,4.753,19.688,9.781c5.428,5.351,11.04,10.887,22.234,10.887 c0.312,0,0.602-0.02,0.905-0.028v-5.169c-0.302,0.011-0.594,0.028-0.905,0.028C173.808,107.748,168.987,102.998,163.888,97.971z"/><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M183.574,113.917c-11.601,0-17.361-5.679-22.932-11.169c-4.964-4.892-9.641-9.499-18.99-9.499 c-9.352,0-14.027,4.608-18.977,9.486c-5.581,5.503-11.341,11.182-22.942,11.182c-11.601,0-17.361-5.68-22.932-11.173 c-4.957-4.886-9.632-9.495-18.985-9.495c-9.352,0-14.026,4.608-18.974,9.485c-5.583,5.504-11.343,11.183-22.943,11.183 c-0.087,0-0.17-0.003-0.253-0.007l-1.125-0.02v-7.17l1.379,0.027c9.355,0,14.031-4.609,18.981-9.489 c5.57-5.494,11.33-11.175,22.936-11.175c11.608,0,17.367,5.681,22.936,11.175c4.957,4.884,9.631,9.489,18.981,9.489 c9.354,0,14.03-4.607,18.979-9.487c5.574-5.497,11.334-11.177,22.939-11.177c11.604,0,17.365,5.681,22.938,11.175 c4.95,4.88,9.626,9.489,18.984,9.489c0.209,0,0.408-0.009,0.608-0.018l1.297-0.047v7.176l-1.278,0.041 C183.994,113.908,183.789,113.917,183.574,113.917z M57.816,91.249c10.173,0,15.132,4.889,20.382,10.065 c5.291,5.216,10.754,10.603,21.535,10.603c10.782,0,16.245-5.386,21.527-10.595c5.261-5.186,10.22-10.073,20.392-10.073 c10.17,0,15.129,4.887,20.381,10.06c5.281,5.207,10.729,10.576,21.446,10.608v-3.169c-10.114-0.03-15.06-4.905-20.294-10.065 c-5.285-5.21-10.75-10.599-21.533-10.599c-10.785,0-16.248,5.388-21.531,10.598c-5.254,5.178-10.213,10.066-20.388,10.066 c-10.17,0-15.128-4.885-20.376-10.056c-5.292-5.22-10.753-10.608-21.541-10.608c-10.786,0-16.249,5.388-21.531,10.599 c-5.143,5.069-10.006,9.864-19.765,10.06v3.169c10.37-0.203,15.725-5.481,20.906-10.589C42.687,96.136,47.645,91.249,57.816,91.249 z"/></g><g><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M163.888,76.934c-5.43-5.352-11.042-10.884-22.235-10.884c-11.195,0-16.806,5.532-22.234,10.884 c-5.101,5.031-9.918,9.781-19.685,9.781c-9.766,0-14.581-4.75-19.684-9.781C74.623,71.582,69.011,66.05,57.816,66.05 c-11.193,0-16.806,5.532-22.233,10.884c-5.1,5.031-9.919,9.781-19.684,9.781c-0.13,0-0.25-0.011-0.379-0.012v5.165 c0.129,0.002,0.249,0.012,0.379,0.012c11.192,0,16.806-5.532,22.233-10.883c5.101-5.031,9.917-9.782,19.684-9.782 c9.766,0,14.584,4.751,19.685,9.782c5.427,5.351,11.04,10.883,22.232,10.883c11.194,0,16.807-5.532,22.233-10.883 c5.102-5.031,9.919-9.782,19.686-9.782c9.766,0,14.584,4.751,19.688,9.782c5.428,5.351,11.04,10.883,22.234,10.883 c0.312,0,0.602-0.019,0.905-0.028v-5.165c-0.302,0.011-0.594,0.028-0.905,0.028C173.808,86.715,168.987,81.965,163.888,76.934z"/><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M183.574,92.88c-11.604,0-17.365-5.679-22.937-11.171c-4.953-4.883-9.631-9.494-18.985-9.494 c-9.356,0-14.033,4.612-18.983,9.494c-5.57,5.492-11.329,11.171-22.936,11.171c-11.605,0-17.364-5.679-22.935-11.171 c-4.95-4.882-9.625-9.494-18.982-9.494c-9.356,0-14.032,4.612-18.981,9.494C33.264,87.201,27.503,92.88,15.899,92.88 c-0.087,0-0.17-0.003-0.253-0.007l-1.125-0.02v-7.158l1.379,0.02c9.359,0,14.033-4.611,18.981-9.493 c5.571-5.493,11.331-11.172,22.936-11.172c11.607,0,17.366,5.679,22.936,11.172c4.953,4.883,9.628,9.493,18.981,9.493 c9.358,0,14.033-4.611,18.982-9.493c5.573-5.494,11.333-11.172,22.937-11.172c11.603,0,17.364,5.679,22.936,11.17 c4.95,4.883,9.624,9.495,18.986,9.495c0.209,0,0.408-0.009,0.608-0.017l1.297-0.047v7.169l-1.251,0.042 C184.014,92.871,183.799,92.88,183.574,92.88z M57.816,70.215c10.178,0,15.137,4.892,20.387,10.07 c5.283,5.208,10.746,10.595,21.53,10.595c10.786,0,16.249-5.386,21.531-10.595c5.251-5.179,10.211-10.07,20.388-10.07 c10.175,0,15.136,4.891,20.389,10.069c5.27,5.195,10.717,10.564,21.438,10.596v-3.165c-10.118-0.03-15.062-4.907-20.294-10.069 c-5.285-5.209-10.75-10.596-21.533-10.596s-16.246,5.385-21.529,10.594c-5.252,5.18-10.211,10.071-20.39,10.071 c-10.174,0-15.133-4.89-20.383-10.066C74.065,72.437,68.603,67.05,57.816,67.05c-10.785,0-16.248,5.387-21.531,10.596 c-5.141,5.072-10.002,9.868-19.765,10.063v3.166c10.374-0.203,15.729-5.481,20.91-10.589C42.681,75.106,47.64,70.215,57.816,70.215 z"/></g><g><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M163.888,119.004c-5.43-5.351-11.042-10.884-22.235-10.884c-11.195,0-16.806,5.533-22.234,10.884 c-5.101,5.031-9.918,9.781-19.685,9.781c-9.766,0-14.581-4.75-19.684-9.781c-5.427-5.351-11.039-10.884-22.233-10.884 c-11.193,0-16.806,5.533-22.233,10.884c-5.1,5.031-9.919,9.781-19.684,9.781c-0.13,0-0.25-0.01-0.379-0.012v5.165 c0.129,0.002,0.249,0.012,0.379,0.012c11.192,0,16.806-5.532,22.233-10.883c5.101-5.031,9.917-9.781,19.684-9.781 c9.766,0,14.584,4.75,19.685,9.781c5.427,5.351,11.04,10.883,22.232,10.883c11.194,0,16.807-5.532,22.233-10.883 c5.102-5.031,9.919-9.781,19.686-9.781c9.766,0,14.584,4.75,19.688,9.781c5.428,5.351,11.04,10.883,22.234,10.883 c0.312,0,0.602-0.019,0.905-0.028v-5.165c-0.302,0.011-0.594,0.028-0.905,0.028C173.808,128.785,168.987,124.035,163.888,119.004z" /><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M183.574,134.95c-11.604,0-17.365-5.679-22.937-11.171c-4.952-4.882-9.63-9.493-18.985-9.493 c-9.357,0-14.033,4.611-18.983,9.493c-5.57,5.492-11.329,11.171-22.936,11.171c-11.605,0-17.364-5.679-22.935-11.171 c-4.949-4.882-9.624-9.493-18.982-9.493c-9.357,0-14.032,4.611-18.981,9.493c-5.571,5.492-11.332,11.171-22.936,11.171 c-0.087,0-0.17-0.003-0.253-0.007l-1.125-0.02v-7.166l1.379,0.027c9.359,0,14.033-4.611,18.981-9.493 c5.572-5.493,11.333-11.172,22.936-11.172c11.604,0,17.365,5.679,22.936,11.172c4.953,4.884,9.628,9.493,18.981,9.493 c9.358,0,14.033-4.611,18.982-9.493c5.575-5.495,11.335-11.172,22.937-11.172c11.601,0,17.361,5.677,22.934,11.167 c4.952,4.887,9.626,9.498,18.988,9.498c0.209,0,0.408-0.009,0.608-0.018l1.297-0.047v7.17l-1.251,0.041 C184.014,134.941,183.799,134.95,183.574,134.95z M57.816,112.286c10.179,0,15.137,4.892,20.387,10.069 c5.283,5.209,10.746,10.595,21.53,10.595c10.786,0,16.249-5.386,21.531-10.595c5.251-5.178,10.21-10.069,20.388-10.069 c10.176,0,15.137,4.892,20.39,10.069c5.269,5.193,10.716,10.562,21.438,10.595v-3.165c-10.118-0.03-15.062-4.907-20.294-10.069 c-5.288-5.211-10.752-10.596-21.533-10.596s-16.244,5.384-21.527,10.591c-5.254,5.184-10.213,10.074-20.392,10.074 c-10.174,0-15.133-4.89-20.383-10.066c-5.286-5.212-10.75-10.599-21.534-10.599c-10.783,0-16.247,5.386-21.53,10.595 c-5.142,5.072-10.003,9.869-19.766,10.064v3.165c10.374-0.203,15.729-5.481,20.91-10.589 C42.68,117.178,47.639,112.286,57.816,112.286z"/></g></svg>';case"heart":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M100.857,149.971l-1.664-1.108c-0.396-0.265-9.854-6.593-21.034-16.174c-15.13-12.966-25.576-25.093-31.049-36.041 c-4.48-8.961-3.554-20.14,2.479-29.903c6.141-9.937,16.242-16.109,26.361-16.109c6.568,0,15.979,2.534,24.906,14.006 c8.923-11.473,18.333-14.006,24.901-14.006c10.118,0,20.219,6.173,26.361,16.111c6.033,9.763,6.961,20.941,2.48,29.902 c-5.474,10.948-15.92,23.075-31.048,36.041c-11.179,9.581-20.635,15.909-21.031,16.173L100.857,149.971z M75.951,56.635 c-8.056,0-16.201,5.083-21.258,13.264c-4.932,7.981-5.761,16.978-2.216,24.066c10.766,21.538,40.951,43.557,48.38,48.758 c7.428-5.201,37.608-27.221,48.376-48.758c3.544-7.087,2.715-16.083-2.218-24.064c-5.057-8.183-13.202-13.266-21.257-13.266 c-8.201,0-15.949,5.119-22.405,14.804l-2.496,3.744l-2.496-3.744C91.903,61.754,84.153,56.635,75.951,56.635z"/></svg>';case"bolt":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M76.247,183.564l19.897-73.016l-30.646,8.619L124.41,16.836l-18.489,70.369l30.463-7.496L76.247,183.564z M103.289,103.345 l-12.116,44.466l34.996-60.438L98.948,94.07l11.108-42.281l-34.107,59.244L103.289,103.345z"/></svg>';case"balls":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><g> <g> <circle fill="#FFFFFF" cx="29.57" cy="100" r="6.961"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M29.569,109.461c-5.217,0-9.461-4.244-9.461-9.461c0-5.217,4.244-9.461,9.461-9.461c5.217,0,9.462,4.244,9.462,9.461 C39.031,105.217,34.787,109.461,29.569,109.461z M29.569,95.539c-2.46,0-4.461,2.001-4.461,4.461s2.001,4.461,4.461,4.461 c2.46,0,4.462-2.001,4.462-4.461S32.03,95.539,29.569,95.539z"/> </g> <g> <circle fill="#FFFFFF" cx="40.77" cy="100" r="11.2"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M40.77,113.699c-7.554,0-13.7-6.145-13.7-13.699s6.146-13.7,13.7-13.7s13.7,6.146,13.7,13.7S48.324,113.699,40.77,113.699 z M40.77,91.3c-4.797,0-8.7,3.903-8.7,8.7c0,4.796,3.903,8.699,8.7,8.699s8.7-3.902,8.7-8.699 C49.47,95.203,45.567,91.3,40.77,91.3z"/> </g> <g> <circle fill="#FFFFFF" cx="56.45" cy="100.001" r="15.68"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M56.45,118.18c-10.025,0-18.181-8.154-18.181-18.179c0-10.025,8.156-18.181,18.181-18.181 c10.024,0,18.18,8.156,18.18,18.181C74.63,110.025,66.475,118.18,56.45,118.18z M56.45,86.82c-7.268,0-13.181,5.913-13.181,13.181 c0,7.267,5.913,13.179,13.181,13.179c7.267,0,13.18-5.912,13.18-13.179C69.63,92.733,63.717,86.82,56.45,86.82z"/> </g> <g> <path fill="#FFFFFF" d="M97.411,100.001c0,12.124-9.826,21.95-21.951,21.95s-21.953-9.826-21.953-21.95 c0-12.126,9.828-21.953,21.953-21.953S97.411,87.875,97.411,100.001z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M75.46,124.451c-13.483,0-24.453-10.968-24.453-24.45c0-13.483,10.97-24.453,24.453-24.453 c13.482,0,24.451,10.97,24.451,24.453C99.911,113.483,88.942,124.451,75.46,124.451z M75.46,80.548 c-10.727,0-19.453,8.727-19.453,19.453c0,10.725,8.727,19.45,19.453,19.45c10.726,0,19.451-8.725,19.451-19.45 C94.911,89.275,86.186,80.548,75.46,80.548z"/> </g> <g> <path fill="#FFFFFF" d="M131.52,100.002c0,16.973-13.757,30.73-30.732,30.73c-16.975,0-30.734-13.758-30.734-30.73 c0-16.977,13.76-30.734,30.734-30.734C117.763,69.268,131.52,83.025,131.52,100.002z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M100.787,133.232c-18.326,0-33.234-14.907-33.234-33.23c0-18.326,14.909-33.234,33.234-33.234 c18.324,0,33.232,14.909,33.232,33.234C134.02,118.325,119.111,133.232,100.787,133.232z M100.787,71.768 c-15.568,0-28.234,12.666-28.234,28.234c0,15.566,12.666,28.23,28.234,28.23c15.567,0,28.232-12.664,28.232-28.23 C129.02,84.434,116.354,71.768,100.787,71.768z"/> </g> <g> <path fill="#FFFFFF" d="M177.392,100.002c0,23.762-19.26,43.023-43.025,43.023c-23.765,0-43.028-19.262-43.028-43.023 c0-23.767,19.264-43.027,43.028-43.027C158.132,56.975,177.392,76.235,177.392,100.002z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M134.366,145.525c-25.104,0-45.528-20.422-45.528-45.523c0-25.104,20.424-45.527,45.528-45.527 c25.103,0,45.525,20.423,45.525,45.527C179.892,125.104,159.469,145.525,134.366,145.525z M134.366,59.475 c-22.347,0-40.528,18.181-40.528,40.527c0,22.345,18.182,40.523,40.528,40.523c22.346,0,40.525-18.179,40.525-40.523 C174.892,77.655,156.712,59.475,134.366,59.475z"/> </g></g></svg>';case"drips":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><g> <path fill="rgba('+t+", "+i+", "+n+","+r+')" fill-rule="evenodd" clip-rule="evenodd" d="M101.807,72.491c2.018-6.874,5.617-16.757,1.506-23.193 c-3.905-6.113-11.555-2.917-9.19,2.807c0.845,2.044,2.733,4.043,4.164,5.59C102.023,61.739,102.396,67.181,101.807,72.491z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" fill-rule="evenodd" clip-rule="evenodd" d="M102.5,78.583c3.533-7.633,8.01-19.14,16.618-21.642 c8.178-2.376,12.458,6.369,5.941,9.589c-2.327,1.153-5.542,1.453-8.001,1.715C110.631,68.921,106.088,73.441,102.5,78.583z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" fill-rule="evenodd" clip-rule="evenodd" d="M91.772,109.562c-3.189,0-5.788-2.6-5.788-5.787c0-3.188,2.599-5.789,5.788-5.789 c3.187,0,5.787,2.6,5.787,5.789C97.559,106.963,94.959,109.562,91.772,109.562z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" fill-rule="evenodd" clip-rule="evenodd" d="M92.194,131.234c-6.503-19.299-14.249-48.189-34.315-56.477 c-19.065-7.87-31.666,12.05-16.825,21.523c5.301,3.386,12.955,4.963,18.809,6.231C75.167,105.832,84.912,117.914,92.194,131.234z" /> <path fill="rgba('+t+", "+i+", "+n+","+r+')" fill-rule="evenodd" clip-rule="evenodd" d="M76.101,133.059c-3.35,0-6.083-2.73-6.083-6.082c0-3.35,2.733-6.082,6.083-6.082 s6.083,2.732,6.083,6.082C82.184,130.328,79.451,133.059,76.101,133.059z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" fill-rule="evenodd" clip-rule="evenodd" d="M89.065,158.012c5.576-29.148,11.079-72.364,38.403-88.272 c25.97-15.111,48.07,11.163,28.528,27.756c-6.976,5.93-17.731,9.706-25.92,12.691C108.635,117.994,96.933,137.352,89.065,158.012z" /> <path fill="rgba('+t+", "+i+", "+n+","+r+')" fill-rule="evenodd" clip-rule="evenodd" d="M87.855,94.271c-7.565,0-13.765-6.177-13.765-13.762 c0-7.574,6.2-13.766,13.765-13.766c7.582,0,13.779,6.192,13.779,13.766C101.635,88.095,95.438,94.271,87.855,94.271z"/></g></svg>';case"flames":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><g> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M63.483,90.598c-3.254,1.794-8.575,0.489-11.714,3.509c-5.267,5.55-0.616,10.749,2.557,11.73 c1.243,0.247,15.215,4.718,19.764-14.904c3.639-20.603,16.573-21.23,18.261-21.391c9.035-0.595,18.811,12.88,30.622,1.43 c-9.957,14.972-25.383,1.251-32.25,5.278c-6.976,5.473,0.198,14.331,8.895,14.506c8.654-0.223,23.721-21.253,39.99-20.315 c14.516,0.197,26.641,9.619,38.249,3.321c-17.349,13.542-34.842-6.068-46.412,7.426c-7.613,10.392,1.68,16.533,5.605,12.43 c4.882-5.322,5.061-10.038,15.093-13.023c-1.984,0.992-6.08,1.887-8.061,7.266c-7.678,19.46-15.369,10.928-32.023,8.443 c-21.055-1.89-38.226,8.402-34.416,16.959c6.045,10.555,14.871-2.84,17.743-5.967c12.424-13.883,18.651-0.719,28.922-3.318 c-9.886,4.56-10.58-2.643-18.756,0.986c-9.647,4.283-6.109,17.09-24.423,20.043c-12.009,2.284-14.78-4.71-27.778-7.777 c-4.35-1.104-8.429,0.705-8.606,4.795c1.343,10.4,13.821-1.748,21.315,3.486c-9.809-1.088-9.978,6.889-18.995,6.968 c-10.778-0.355-19.255-8.405-22.362-21.401c-2.542-13.35,3.411-25.616,21.315-24.789c27.918,2.146,21.619-8.761,32.04-14.024 C70.507,78.472,74.096,85.54,63.483,90.598"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M47.063,132.568h-0.002c-5.319-0.176-10.201-2.246-14.117-5.986c-3.923-3.746-6.804-9.101-8.33-15.484 c-1.417-7.443-0.151-14.012,3.563-18.5c3.758-4.541,9.958-6.764,17.844-6.4c2.383,0.183,4.598,0.276,6.586,0.276 c13.106,0,15.871-3.9,18.799-8.03c1.586-2.238,3.227-4.552,6.61-6.261l0.099,0.15c-3.255,2.676-4.435,5.528-5.576,8.287 c-1.528,3.692-2.972,7.179-9.017,10.06c-1.384,0.763-3.106,0.966-4.931,1.181c-2.441,0.288-4.967,0.586-6.76,2.311 c-2.521,2.657-2.568,5.06-2.164,6.606c0.65,2.49,2.899,4.419,4.685,4.972c0.053,0.011,0.146,0.033,0.267,0.062 c0.666,0.162,2.224,0.541,4.195,0.541c5.295,0,12.229-2.679,15.188-15.441c1.499-8.489,4.732-14.617,9.61-18.208 c2.545-1.873,5.435-2.963,8.587-3.24l0.143-0.013c0.199-0.013,0.399-0.02,0.601-0.02c2.966,0,5.978,1.389,9.166,2.858 c3.434,1.583,6.983,3.219,10.743,3.219c3.573,0,6.863-1.505,10.059-4.603l0.138,0.115c-3.234,4.863-7.427,7.228-12.817,7.228 c-3.174,0-6.29-0.76-9.305-1.495c-2.51-0.612-4.882-1.19-6.893-1.19c-1.321,0-2.39,0.25-3.265,0.763 c-2.446,1.92-3.312,4.438-2.428,7.084c1.348,4.033,6.196,7.151,11.278,7.253c3.505-0.09,8.1-3.648,13.42-7.768 c7.237-5.604,16.244-12.579,25.506-12.579c0.356,0,0.715,0.011,1.067,0.031c5.645,0.077,10.889,1.535,15.959,2.946 c4.698,1.307,9.136,2.541,13.459,2.541c3.237,0,6.11-0.705,8.783-2.155l0.099,0.151c-4.416,3.447-9.129,5.052-14.832,5.053 c-0.001,0-0.002,0-0.003,0c-3.783,0-7.47-0.704-11.035-1.385c-3.304-0.631-6.424-1.227-9.392-1.227 c-4.689,0-8.229,1.581-11.138,4.974c-3.861,5.271-3.026,8.846-2.184,10.507c0.942,1.858,2.782,3.059,4.688,3.059 c1.154,0,2.181-0.435,2.968-1.258c1.358-1.48,2.345-2.905,3.298-4.282c2.454-3.544,4.574-6.605,11.835-8.765l0.065,0.167 c-0.311,0.155-0.678,0.311-1.067,0.475c-2.106,0.89-5.289,2.234-6.948,6.741c-4.338,10.995-8.667,12.51-12.7,12.51 c-2.685,0-5.699-0.803-9.191-1.734c-2.989-0.797-6.378-1.7-10.23-2.275c-1.669-0.149-3.366-0.226-5.039-0.226 c-6.442,0-12.655,1.104-17.965,3.192c-4.929,1.938-8.672,4.591-10.54,7.467c-1.406,2.167-1.675,4.38-0.775,6.399 c1.493,2.606,3.288,3.932,5.332,3.932c4.098,0,8.351-5.193,10.891-8.297c0.539-0.658,1.004-1.227,1.371-1.625 c3.971-4.438,7.626-6.505,11.502-6.505c2.54,0,4.935,0.884,7.25,1.738c2.355,0.87,4.791,1.769,7.421,1.769 c0.954,0,1.868-0.113,2.793-0.348l0.061,0.17c-2.301,1.061-4.306,1.576-6.132,1.576c-1.697,0-3.04-0.434-4.339-0.854 c-1.256-0.407-2.442-0.79-3.899-0.79c-1.352,0-2.787,0.345-4.387,1.055c-3.8,1.688-5.55,4.723-7.401,7.936 c-2.79,4.84-5.952,10.326-17.044,12.114c-1.597,0.304-3.056,0.452-4.461,0.452c-4.63,0-7.831-1.653-11.536-3.567 c-3.132-1.618-6.681-3.451-11.816-4.663c-0.826-0.209-1.649-0.315-2.448-0.315c-3.541,0-5.915,1.973-6.048,5.026 c0.383,2.949,1.664,4.271,4.153,4.271c1.541,0,3.396-0.494,5.359-1.018c2.28-0.608,4.639-1.236,6.916-1.236 c1.922,0,3.508,0.455,4.849,1.391L66.05,125.6c-0.607-0.066-1.197-0.102-1.756-0.102c-3.988,0-6.122,1.676-8.381,3.449 c-2.244,1.762-4.564,3.583-8.848,3.621H47.063z M44.333,86.338c-7.026,0-12.564,2.204-16.016,6.375 c-3.681,4.447-4.933,10.963-3.526,18.347c1.518,6.346,4.38,11.67,8.278,15.392c3.883,3.709,8.724,5.762,13.996,5.936 c4.221-0.037,6.517-1.84,8.736-3.582c2.184-1.715,4.441-3.486,8.492-3.486c0.452,0,0.925,0.021,1.41,0.065 c-1.244-0.779-2.701-1.159-4.441-1.159c-2.254,0-4.601,0.626-6.87,1.23c-1.975,0.527-3.841,1.024-5.405,1.024 c-2.564,0-3.941-1.412-4.333-4.444c0.135-3.126,2.638-5.215,6.228-5.215c0.813,0,1.652,0.107,2.491,0.32 c5.155,1.217,8.716,3.056,11.856,4.678c3.685,1.904,6.867,3.547,11.453,3.547c1.394,0,2.842-0.146,4.43-0.449 c11.01-1.774,14.148-7.221,16.918-12.025c1.867-3.24,3.632-6.3,7.484-8.011c1.624-0.721,3.083-1.071,4.461-1.071 c1.485,0,2.685,0.389,3.955,0.8c1.285,0.416,2.614,0.847,4.283,0.846c1.583,0,3.307-0.396,5.248-1.205 c-0.648,0.112-1.299,0.169-1.97,0.169c-2.662,0-5.113-0.906-7.484-1.781c-2.3-0.849-4.679-1.727-7.187-1.727 c-3.82,0-7.434,2.048-11.368,6.445c-0.364,0.396-0.828,0.963-1.364,1.618c-2.562,3.128-6.849,8.364-11.031,8.364 c-2.113,0-3.962-1.356-5.493-4.031c-0.93-2.087-0.657-4.359,0.785-6.58c1.889-2.908,5.662-5.584,10.625-7.536 c5.331-2.097,11.566-3.205,18.031-3.205c1.678,0,3.381,0.077,5.061,0.228c3.868,0.577,7.262,1.481,10.256,2.28 c3.479,0.927,6.484,1.728,9.145,1.728c3.969,0,8.233-1.501,12.531-12.394c1.521-4.129,4.294-5.643,6.39-6.562 c-5.791,2.095-7.735,4.903-9.956,8.111c-0.958,1.382-1.947,2.812-3.315,4.303c-0.812,0.849-1.912,1.315-3.1,1.315 c-1.973,0-3.876-1.24-4.849-3.158c-0.861-1.698-1.72-5.346,2.203-10.701c2.951-3.441,6.533-5.042,11.279-5.042 c2.984,0,6.113,0.598,9.426,1.23c3.557,0.679,7.235,1.382,11.001,1.382c0.001,0,0.002,0,0.003,0c5.31,0,9.753-1.402,13.9-4.398 c-2.438,1.15-5.05,1.71-7.95,1.71c-4.349,0-8.797-1.237-13.508-2.548c-5.06-1.407-10.291-2.862-15.916-2.939 c-0.354-0.02-0.709-0.03-1.062-0.03c-9.199,0-17.804,6.662-25.396,12.541c-5.345,4.139-9.962,7.713-13.53,7.805 c-5.158-0.104-10.079-3.275-11.45-7.376c-0.91-2.724-0.023-5.313,2.498-7.291c0.914-0.537,2.012-0.794,3.366-0.794 c2.033,0,4.414,0.581,6.936,1.196c3.004,0.732,6.109,1.49,9.262,1.489c5.138,0,9.03-2.057,12.189-6.456 c-3.038,2.742-6.176,4.078-9.568,4.078c-3.8,0-7.368-1.645-10.819-3.236c-3.169-1.461-6.163-2.841-9.09-2.841 c-0.196,0-0.394,0.006-0.586,0.019l-0.141,0.013c-3.12,0.273-5.979,1.352-8.496,3.205c-4.839,3.563-8.049,9.652-9.541,18.099 c-2.986,12.882-10.004,15.587-15.364,15.587c-0.001,0,0,0,0,0c-1.993,0-3.566-0.383-4.237-0.547 c-0.118-0.029-0.209-0.051-0.269-0.062c-1.887-0.584-4.142-2.521-4.816-5.103c-0.416-1.591-0.369-4.059,2.212-6.779 c1.84-1.771,4.396-2.072,6.867-2.363c1.806-0.213,3.512-0.415,4.868-1.163c5.987-2.854,7.418-6.31,8.932-9.969 c1.074-2.593,2.182-5.27,4.999-7.814c-2.861,1.643-4.361,3.759-5.816,5.812c-2.955,4.168-5.746,8.106-18.946,8.106 c-1.992,0-4.212-0.093-6.597-0.276C45.446,86.351,44.882,86.338,44.333,86.338z"/></g></svg>';case"grid":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><g> <g> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="104.088" y="132.575" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -67.3253 122.6343)" width="20.564" height="20.023"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="133.034" y="132.249" transform="matrix(0.7071 -0.7072 0.7072 0.7071 -58.8638 142.9646)" width="20.182" height="20.563"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="104.142" y="103.742" transform="matrix(0.707 0.7072 -0.7072 0.707 114.0192 -47.5699)" width="20.566" height="20.179"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="132.899" y="103.764" transform="matrix(-0.7071 0.7071 -0.7071 -0.7071 324.8759 92.9823)" width="20.564" height="20.023"/> </g> <g> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="46.538" y="132.575" transform="matrix(0.7072 -0.7071 0.7071 0.7072 -84.1771 81.931)" width="20.565" height="20.023"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="75.484" y="132.249" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -75.7197 102.257)" width="20.183" height="20.563"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="46.592" y="103.742" transform="matrix(0.707 0.7072 -0.7072 0.707 97.1598 -6.8727)" width="20.566" height="20.181"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="75.349" y="103.763" transform="matrix(-0.7071 0.7071 -0.7071 -0.7071 226.6322 133.6762)" width="20.564" height="20.024"/> </g> <g> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="104.088" y="76.215" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -27.4725 106.1268)" width="20.564" height="20.022"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="133.034" y="75.888" transform="matrix(0.7071 -0.7072 0.7072 0.7071 -19.0079 126.4542)" width="20.182" height="20.563"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="104.142" y="47.382" transform="matrix(0.7071 0.7072 -0.7072 0.7071 74.1607 -64.0803)" width="20.565" height="20.179"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="132.899" y="47.403" transform="matrix(-0.7071 0.7071 -0.7071 -0.7071 285.0229 -3.2313)" width="20.564" height="20.023"/> </g> <g> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="46.538" y="76.215" transform="matrix(0.7072 -0.7071 0.7071 0.7072 -44.327 65.4261)" width="20.565" height="20.022"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="75.484" y="75.888" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -35.8666 85.7492)" width="20.183" height="20.563"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="46.537" y="47.381" transform="matrix(0.7071 0.7072 -0.7072 0.7071 57.2857 -23.3444)" width="20.565" height="20.18"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="75.349" y="47.403" transform="matrix(-0.7071 0.7071 -0.7071 -0.7071 186.7792 37.4626)" width="20.564" height="20.024"/> </g></g></svg>';case"cube":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><g><polygon fill="rgba('+t+", "+i+", "+n+","+r+')" points="50.689,71.558 58.907,76.305 108.227,47.858 100.002,43.115    "/><polygon fill="rgba('+t+", "+i+", "+n+","+r+')" points="67.123,81.049 75.342,85.795 124.66,57.351 116.437,52.606   "/><polygon fill="rgba('+t+", "+i+", "+n+","+r+')" points="83.558,90.541 91.775,95.286 141.095,66.842 132.87,62.1     "/><polygon fill="rgba('+t+", "+i+", "+n+","+r+')" points="100.002,156.885 100.003,147.394 50.689,118.91 50.689,128.442   "/><polygon fill="rgba('+t+", "+i+", "+n+","+r+')" points="100.005,137.905 100.007,128.416 50.686,99.938 50.689,109.433   "/><polygon fill="rgba('+t+", "+i+", "+n+","+r+')" points="100.008,118.929 100.01,109.438 50.716,80.948 50.72,90.442  "/><polygon fill="rgba('+t+", "+i+", "+n+","+r+')" points="149.314,71.558 141.095,76.301 141.098,133.181 149.314,128.442  "/><polygon fill="rgba('+t+", "+i+", "+n+","+r+')" points="132.877,81.044 124.657,85.787 124.662,142.66 132.879,137.922   "/><polygon fill="rgba('+t+", "+i+", "+n+","+r+')" points="116.439,90.531 108.22,95.273 108.227,152.142 116.444,147.4     "/></g></svg>';case"circles":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><g> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M62.923,108.923c-0.35,3.989-3.862,6.939-7.851,6.59c-3.989-0.348-6.936-3.864-6.591-7.853 c0.35-3.988,3.863-6.936,7.852-6.588C60.324,101.424,63.273,104.935,62.923,108.923z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M151.409,89.511c1.694,3.628,0.125,7.939-3.506,9.631c-3.623,1.691-7.937,0.121-9.63-3.504 c-1.688-3.628-0.125-7.938,3.504-9.632C145.41,84.314,149.722,85.883,151.409,89.511z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M72.172,126.46c1.693,3.631,0.125,7.94-3.504,9.632c-3.627,1.694-7.938,0.121-9.633-3.504 c-1.691-3.629-0.123-7.938,3.506-9.633C66.17,121.266,70.481,122.83,72.172,126.46z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M139.098,65.406c3.28,2.296,4.077,6.813,1.778,10.093c-2.291,3.276-6.812,4.072-10.091,1.781 c-3.275-2.298-4.078-6.813-1.781-10.093C131.305,63.906,135.82,63.107,139.098,65.406z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M88.95,137.023c3.282,2.299,4.079,6.813,1.781,10.095c-2.293,3.28-6.813,4.073-10.095,1.781 c-3.28-2.298-4.075-6.815-1.779-10.095C81.155,135.525,85.67,134.727,88.95,137.023z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M116.383,50.687c3.988,0.349,6.938,3.862,6.587,7.852c-0.347,3.983-3.864,6.933-7.85,6.587 c-3.985-0.35-6.937-3.86-6.589-7.848C108.883,53.285,112.396,50.335,116.383,50.687z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M108.762,137.783c3.992,0.35,6.939,3.862,6.59,7.851c-0.346,3.987-3.863,6.935-7.852,6.591 c-3.988-0.35-6.936-3.864-6.589-7.854C101.263,140.383,104.773,137.433,108.762,137.783z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M89.351,49.296c3.627-1.692,7.938-0.123,9.63,3.508c1.692,3.621,0.121,7.936-3.503,9.629 c-3.627,1.688-7.938,0.125-9.632-3.503C84.156,55.296,85.722,50.984,89.351,49.296z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M126.299,128.534c3.633-1.693,7.943-0.124,9.633,3.505c1.695,3.626,0.122,7.938-3.505,9.634 c-3.628,1.69-7.938,0.12-9.632-3.508C121.105,134.536,122.671,130.226,126.299,128.534z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M65.247,61.607c2.295-3.277,6.812-4.075,10.092-1.777c3.276,2.291,4.073,6.812,1.781,10.091 c-2.296,3.276-6.812,4.077-10.093,1.784C63.746,69.402,62.947,64.886,65.247,61.607z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M136.863,111.757c2.299-3.282,6.816-4.08,10.094-1.781c3.281,2.294,4.075,6.813,1.781,10.096 c-2.296,3.278-6.814,4.074-10.096,1.778C135.365,119.551,134.566,115.035,136.863,111.757z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M50.527,84.322c0.348-3.987,3.861-6.936,7.851-6.585c3.983,0.346,6.934,3.862,6.587,7.85 c-0.35,3.984-3.861,6.937-7.849,6.589C53.124,91.823,50.174,88.312,50.527,84.322z"/></g><g> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="75.462" cy="83.061" r="4.851"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M129.641,119.463c-0.916,2.519-3.698,3.816-6.217,2.899c-2.515-0.914-3.812-3.699-2.898-6.215 c0.918-2.517,3.697-3.815,6.215-2.901C129.261,114.165,130.559,116.948,129.641,119.463z"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="70.1" cy="97.793" r="4.851"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M135.221,102.23c0.467,2.64-1.295,5.153-3.934,5.618c-2.635,0.466-5.15-1.297-5.619-3.934 c-0.463-2.636,1.295-5.153,3.934-5.618C132.242,97.834,134.758,99.592,135.221,102.23z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M77.6,112.39c0.465,2.642-1.294,5.154-3.934,5.62c-2.638,0.467-5.152-1.297-5.621-3.934 c-0.465-2.641,1.297-5.153,3.935-5.619C74.619,107.992,77.134,109.751,77.6,112.39z"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M131.438,84.516c1.723,2.052,1.455,5.111-0.598,6.832c-2.049,1.723-5.109,1.453-6.832-0.597 c-1.722-2.052-1.456-5.109,0.595-6.832C126.66,82.196,129.717,82.463,131.438,84.516z"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="82.899" cy="125.244" r="4.85"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M119.304,71.065c2.518,0.915,3.815,3.698,2.897,6.218c-0.913,2.514-3.698,3.812-6.215,2.897 c-2.516-0.917-3.816-3.696-2.9-6.215C114.006,71.446,116.787,70.146,119.304,71.065z"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="97.632" cy="130.606" r="4.85"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M102.07,65.484c2.638-0.465,5.153,1.295,5.617,3.935c0.467,2.635-1.295,5.152-3.933,5.619 c-2.637,0.463-5.153-1.295-5.621-3.933C97.672,68.464,99.431,65.948,102.07,65.484z"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="113.072" cy="127.884" r="4.85"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M84.355,69.268c2.052-1.722,5.11-1.455,6.832,0.599c1.722,2.049,1.455,5.109-0.597,6.833 c-2.051,1.72-5.11,1.455-6.832-0.596C82.036,74.046,82.302,70.989,84.355,69.268z"/></g><g> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="97.263" cy="83.369" r="2.775"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M104.455,120.013c-1.39,0.647-3.04,0.048-3.688-1.342c-0.648-1.387-0.046-3.039,1.341-3.688 c1.39-0.646,3.039-0.048,3.688,1.341C106.443,117.716,105.844,119.367,104.455,120.013z"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="89.135" cy="87.159" r="2.775"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="111.41" cy="113.707" r="2.775"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="83.99" cy="94.507" r="2.776"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="116.555" cy="106.36" r="2.775"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="83.207" cy="103.442" r="2.775"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M119.852,96.253c0.648,1.388,0.048,3.039-1.344,3.687c-1.385,0.647-3.037,0.046-3.686-1.343 c-0.646-1.389-0.049-3.038,1.34-3.688C117.555,94.263,119.206,94.861,119.852,96.253z"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="86.998" cy="111.571" r="2.775"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="113.547" cy="89.295" r="2.775"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="94.345" cy="116.716" r="2.775"/> <path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M106.441,81.387c1.525,0.133,2.656,1.478,2.521,3.005c-0.133,1.526-1.479,2.656-3.006,2.523 c-1.525-0.134-2.656-1.479-2.523-3.005C103.57,82.381,104.914,81.252,106.441,81.387z"/></g><g> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="105.747" cy="92.615" r="1.529"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="94.798" cy="108.252" r="1.528"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="101.105" cy="90.924" r="1.528"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="99.441" cy="109.942" r="1.528"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="96.239" cy="91.783" r="1.53"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="104.307" cy="109.085" r="1.528"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="92.453" cy="94.958" r="1.529"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="108.092" cy="105.909" r="1.528"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="90.764" cy="99.601" r="1.529"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="109.782" cy="101.266" r="1.529"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="91.621" cy="104.467" r="1.529"/> <circle fill="rgba('+t+", "+i+", "+n+","+r+')" cx="108.924" cy="96.4" r="1.528"/></g></svg>';

case"shield":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><g><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M142.824,81.079c-0.005-0.145-0.007-0.291-0.019-0.432c-0.235-4.191-2.952-8.801-6.518-10.924l-29.664-17.67c-1.024-0.611-2.061-0.98-3.089-1.113c-1.143-0.297-2.372-0.455-3.626-0.455c-1.345,0-2.651,0.184-3.859,0.523c-0.891,0.17-1.785,0.515-2.674,1.045l-29.661,17.67c-3.564,2.123-6.287,6.738-6.519,10.934c-0.01,0.139-0.016,0.284-0.018,0.427c-0.002,0.052-0.008,0.101-0.008,0.151v0.065v37.398v0.067c0,0.05,0.006,0.103,0.008,0.153c0.003,0.147,0.008,0.293,0.018,0.432c0.236,4.192,2.957,8.804,6.519,10.926l29.662,17.671c1.028,0.609,2.063,0.979,3.091,1.11c1.143,0.3,2.372,0.456,3.626,0.456c1.344,0,2.649-0.182,3.86-0.521c0.893-0.172,1.784-0.518,2.672-1.047l29.662-17.669c3.566-2.124,6.284-6.739,6.518-10.934c0.012-0.14,0.014-0.284,0.019-0.428c0-0.051,0.005-0.103,0.005-0.149v-0.067V81.301v-0.065C142.829,81.184,142.824,81.131,142.824,81.079z M63.815,118.579V81.421l29.561,17.612l0.027,0.016c0.391,0.236,0.774,0.565,1.133,0.953c-0.367,0.394-0.758,0.729-1.16,0.965L63.815,118.579z M136.188,81.419v37.16l-29.562-17.612l-0.028-0.014c-0.39-0.234-0.772-0.564-1.132-0.951c0.367-0.397,0.759-0.732,1.16-0.969L136.188,81.419z M132.791,75.539c0.044,0.026,0.084,0.053,0.122,0.078c-0.038,0.023-0.076,0.052-0.122,0.077l-29.464,17.562V57.989L132.791,75.539z M96.675,93.263L67.114,75.653c-0.043-0.028-0.084-0.055-0.122-0.081c0.038-0.022,0.079-0.049,0.122-0.074l29.561-17.62V93.263z M67.212,124.461c-0.044-0.026-0.085-0.053-0.125-0.077c0.04-0.026,0.081-0.052,0.125-0.078l29.463-17.563v35.269L67.212,124.461z M103.327,106.739l29.562,17.608c0.044,0.025,0.085,0.052,0.122,0.078c-0.037,0.026-0.078,0.052-0.122,0.076l-29.562,17.62V106.739z"/></g></svg>';case"locking":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><g><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M109.25,83.803c-4.012,0-7.275,3.266-7.275,7.278c0,1.32,0,1.32,0,1.32c0.537,1.271-0.816,4.129-2.996,6.352c-2.188,2.227-4.984,3.638-6.215,3.137c0,0,0,0-1.275,0c-4.01,0-7.275,3.266-7.275,7.277s3.266,7.278,7.275,7.278c4.014,0,7.279-3.267,7.279-7.278c0-1.327,0-1.327,0-1.327c-0.541-1.277,0.799-4.139,2.984-6.362c2.18-2.221,4.98-3.624,6.217-3.119c0,0,0,0,1.281,0c4.014,0,7.279-3.263,7.279-7.277C116.529,87.068,113.264,83.803,109.25,83.803z"/><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M110.24,48.69c-4.014,0-7.275,3.266-7.275,7.278c0,1.32,0,1.32,0,1.32c0.535,1.267-0.814,4.126-2.998,6.352c-2.186,2.224-4.982,3.634-6.215,3.137c0,0,0,0-1.273,0c-4.014,0-7.277,3.263-7.277,7.273c0,4.016,3.264,7.278,7.277,7.278s7.277-3.263,7.277-7.278c0-1.327,0-1.327,0-1.327c-0.543-1.277,0.801-4.135,2.982-6.358s4.982-3.627,6.223-3.123c0,0,0,0,1.279,0c4.016,0,7.277-3.263,7.277-7.273C117.518,51.956,114.256,48.69,110.24,48.69z"/><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M143.869,82.318c-4.01,0-7.275,3.27-7.275,7.278c0,1.323,0,1.323,0,1.323c0.535,1.268-0.814,4.126-2.998,6.349c-2.186,2.227-4.98,3.638-6.213,3.137c0,0,0,0-1.275,0c-4.012,0-7.275,3.266-7.275,7.277c0,4.016,3.264,7.278,7.275,7.278c4.014,0,7.279-3.263,7.279-7.278c0-1.327,0-1.327,0-1.327c-0.541-1.277,0.801-4.139,2.98-6.362c2.184-2.219,4.982-3.624,6.223-3.119c0,0,0,0,1.279,0c4.014,0,7.279-3.263,7.279-7.277C151.148,85.588,147.883,82.318,143.869,82.318z"/><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M73.889,85.039c-4.012,0-7.275,3.267-7.275,7.278c0,1.32,0,1.32,0,1.32c0.535,1.271-0.812,4.129-2.998,6.352c-2.188,2.228-4.98,3.638-6.213,3.137c0,0,0,0-1.275,0c-4.012,0-7.275,3.267-7.275,7.277c0,4.016,3.264,7.278,7.275,7.278c4.014,0,7.277-3.263,7.277-7.278c0-1.327,0-1.327,0-1.327c-0.541-1.277,0.801-4.139,2.984-6.362c2.182-2.223,4.982-3.623,6.221-3.119c0,0,0,0,1.279,0c4.016,0,7.277-3.263,7.277-7.277C81.166,88.306,77.904,85.039,73.889,85.039z"/><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M107.52,118.671c-4.012,0-7.277,3.266-7.277,7.278c0,1.32,0,1.32,0,1.32c0.537,1.267-0.812,4.125-2.998,6.352c-2.186,2.224-4.98,3.634-6.213,3.137c0,0,0,0-1.271,0c-4.014,0-7.279,3.264-7.279,7.276s3.266,7.275,7.279,7.275c4.01,0,7.275-3.263,7.275-7.275c0-1.33,0-1.33,0-1.33c-0.541-1.276,0.799-4.135,2.984-6.358c2.18-2.223,4.98-3.627,6.219-3.12c0,0,0,0,1.281,0c4.016,0,7.279-3.266,7.279-7.276C114.799,121.937,111.535,118.671,107.52,118.671z"/><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M99.381,91.695c0-4.011-3.264-7.277-7.277-7.277c-1.318,0-5.445-0.812-7.672-2.999c-2.221-2.183-3.135-6.211-3.135-7.485c0-4.011-3.266-7.277-7.277-7.277c-4.016,0-7.277,3.267-7.277,7.277c0,4.013,3.262,7.278,7.277,7.278c1.328,0,5.469,0.799,7.689,2.979c2.219,2.183,3.117,6.222,3.117,7.505c0,4.013,3.266,7.275,7.277,7.275C96.117,98.971,99.381,95.708,99.381,91.695z"/><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M133.752,126.066c0-4.013-3.262-7.278-7.271-7.278c-1.322,0-5.449-0.812-7.676-2.996c-2.225-2.187-3.137-6.214-3.137-7.487c0-4.013-3.266-7.278-7.275-7.278c-4.014,0-7.279,3.266-7.279,7.278c0,4.015,3.266,7.277,7.279,7.277c1.326,0,5.467,0.799,7.686,2.982c2.223,2.181,3.123,6.221,3.123,7.502c0,4.015,3.264,7.276,7.279,7.276C130.49,133.343,133.752,130.081,133.752,126.066z"/><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M97.65,127.056c0-4.012-3.264-7.277-7.277-7.277c-1.32,0-5.449-0.813-7.672-2.996c-2.223-2.187-3.137-6.215-3.137-7.488c0-4.012-3.264-7.278-7.275-7.278c-4.014,0-7.277,3.267-7.277,7.278c0,4.011,3.264,7.278,7.277,7.278c1.328,0,5.467,0.798,7.686,2.981c2.223,2.183,3.121,6.221,3.121,7.502c0,4.012,3.268,7.278,7.277,7.278C94.387,134.334,97.65,131.067,97.65,127.056z"/><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M134.248,90.459c0-4.012-3.264-7.277-7.275-7.277c-1.32,0-5.447-0.815-7.674-2.999c-2.225-2.184-3.135-6.212-3.135-7.485c0-4.012-3.266-7.278-7.277-7.278s-7.277,3.267-7.277,7.278c0,4.011,3.266,7.278,7.277,7.278c1.328,0,5.467,0.798,7.688,2.978c2.223,2.187,3.119,6.223,3.119,7.506c0,4.012,3.266,7.274,7.279,7.274C130.984,97.733,134.248,94.471,134.248,90.459z"/></g></svg>';case"seal":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><path fill="rgba('+t+", "+i+", "+n+","+r+')" d="M114.785,171.178L100,137.172l-14.787,34.005l0.322-37.075l-27.333,25.041l15.371-33.735l-35.165,11.765L66.184,112.6 l-36.919-3.562l35.372-11.14L32.361,79.633l36.845,4.206l-22.05-29.817l31.945,18.827L71.07,36.653l21.539,30.179l7.389-36.34 l7.398,36.34l21.529-30.179l-8.021,36.196l31.953-18.832l-22.062,29.821l36.85-4.206L135.37,97.897l35.362,11.14l-36.916,3.562 l27.773,24.572l-35.163-11.765l15.372,33.735l-27.336-25.041L114.785,171.178z M91.655,120.357l-0.186,21.386L100,122.125 l8.529,19.617l-0.186-21.384l15.772,14.448l-8.871-19.468l20.282,6.786l-16.02-14.172l21.291-2.055l-20.396-6.425l18.615-10.534 l-21.254,2.425l12.725-17.198l-18.428,10.861l4.629-20.892l-12.42,17.411l-4.268-20.959L95.74,81.547L83.313,64.136l4.635,20.893 L69.513,74.162l12.721,17.202L60.99,88.939l18.615,10.534l-20.4,6.425l21.288,2.055l-16.02,14.172l20.281-6.786l-8.87,19.468 L91.655,120.357z"/></svg>';case"circleslash":return'<svg version="1.1" id="Your_Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><g> <defs> <circle id="SVGID_1_" cx="106" cy="96" r="55"/> </defs> <clipPath id="SVGID_2_"> <use xlink:href="#SVGID_1_"  overflow="visible"/> </clipPath> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="62.944" y="-32.696" transform="matrix(0.7072 0.707 -0.707 0.7072 64.7871 -26.4693)" clip-path="url(#SVGID_2_)" width="2.814" height="195.359"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="69.481" y="-26.157" transform="matrix(0.7068 0.7074 -0.7074 0.7068 71.3731 -29.1772)" clip-path="url(#SVGID_2_)" width="2.814" height="195.357"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="76.018" y="-19.619" transform="matrix(0.7069 0.7073 -0.7073 0.7069 77.9011 -31.8846)" clip-path="url(#SVGID_2_)" width="2.814" height="195.358"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="82.556" y="-13.081" transform="matrix(0.7069 0.7073 -0.7073 0.7069 84.441 -34.5925)" clip-path="url(#SVGID_2_)" width="2.814" height="195.358"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="89.093" y="-6.544" transform="matrix(0.7068 0.7074 -0.7074 0.7068 90.996 -37.2999)" clip-path="url(#SVGID_2_)" width="2.814" height="195.357"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="95.631" y="-0.007" transform="matrix(0.7069 0.7073 -0.7073 0.7069 97.5205 -40.0089)" clip-path="url(#SVGID_2_)" width="2.815" height="195.358"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="102.168" y="6.531" transform="matrix(0.7069 0.7073 -0.7073 0.7069 104.0597 -42.7162)" clip-path="url(#SVGID_2_)" width="2.814" height="195.358"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="108.706" y="13.068" transform="matrix(0.7069 0.7073 -0.7073 0.7069 110.5993 -45.4245)" clip-path="url(#SVGID_2_)" width="2.814" height="195.357"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="115.242" y="19.606" transform="matrix(0.7068 0.7074 -0.7074 0.7068 117.1593 -48.132)" clip-path="url(#SVGID_2_)" width="2.815" height="195.357"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="121.78" y="26.143" transform="matrix(0.7069 0.7073 -0.7073 0.7069 123.6781 -50.8401)" clip-path="url(#SVGID_2_)" width="2.814" height="195.357"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="128.318" y="32.681" transform="matrix(0.7071 0.7071 -0.7071 0.7071 130.1735 -53.5478)" clip-path="url(#SVGID_2_)" width="2.813" height="195.358"/> <rect fill="rgba('+t+", "+i+", "+n+","+r+')" x="134.856" y="39.217" transform="matrix(0.7075 0.7067 -0.7067 0.7075 136.5923 -56.2565)" clip-path="url(#SVGID_2_)" width="2.814" height="195.359"/></g></svg>'}}var o=this;if(t=e.BaseBrush2D.prototype.draw.call(this,t),null!==this.variant&&"string"==typeof this.variant&&(this.variant!==this._lastVariant||!this.color.isEqual(this._lastColor))){if(-1===this.variants.indexOf(this.variant))throw new Error("BB.ImageBrush2D draw: "+this.variant+" is not a valid variant for BB.ImageBrush2D");var s=this.variant;this.src="data:image/svg+xml;base64,"+window.btoa(i()),this.variant=s,this._lastVariant=this.variant,this._lastColor.copy(this.color)}r||console.error("BB.ImageBrush2D draw: you are attempting to draw an image brush without first setting its source with the .src property"),!this.hidden&&n&&(t.save(),t.translate(this.x,this.y),t.rotate(e.MathUtils.degToRad(this.rotation)),t.drawImage(this._image,-this.width/2,-this.height/2,this.width,this.height),t.restore())},e.ImageBrush2D}),i("BB.LineBrush2D",["./BB","./BB.BaseBrush2D","./BB.Color","./BB.MathUtils"],function(e,t,i,o){"use strict";e.BaseBrush2D=t,e.Color=i,e.MathUtils=o;var n=!1;return e.LineBrush2D=function(t){e.BaseBrush2D.call(this,t),this.prevX=null,this.prevY=null,this.type="line",this.variant="solid",this.weight=1,this.delta=0,this.variants=["solid","ink","ink-osc","soft","lines","calligraphy"],this._lineStartedThisFrame=!this.hidden,t&&("string"==typeof t.variant&&(this.variant=t.variant),"number"==typeof t.weight&&(this.weight=t.weight))},e.LineBrush2D.prototype=Object.create(e.BaseBrush2D.prototype),e.LineBrush2D.prototype.constructor=e.LineBrush2D,e.LineBrush2D.prototype.update=function(t){e.BaseBrush2D.prototype.update.call(this,t),t.hasOwnProperty("isDown")?(n=!0,this.hidden=t.isDown===!1):n=!1},e.LineBrush2D.prototype.draw=function(t){if(t=e.BaseBrush2D.prototype.draw.call(this,t),t.save(),t.lineJoin="round",t.lineCap="round","string"!=typeof this.variant||-1===this.variants.indexOf(this.variant))throw new Error("BB.LineBrush2D.draw: "+this.variant+" is not a valid variant for BB.LineBrush2D");if(this.hidden)this._lineStartedThisFrame=!0;else if(n)if(this._lineStartedThisFrame)t.beginPath(),t.moveTo(this.x,this.y),this._lineStartedThisFrame=!1;else{var i,o,r,s;if(this.color&&this.color instanceof e.Color?(i=this.color.r,o=this.color.g,r=this.color.b,s=e.MathUtils.map(this.color.a,0,255,0,1)):(i=255,o=255,r=255,s=1),"solid"==this.variant)t.lineWidth=this.weight,t.lineTo(this.x,this.y),t.strokeStyle="rgba("+i+", "+o+", "+r+", "+s+")",t.stroke(),t.closePath(),t.beginPath(),t.moveTo(this.x,this.y);else if("ink"==this.variant){var a=this.prevX>this.x?this.prevX-this.x:this.x-this.prevX,h=this.prevY>this.y?this.prevY-this.y:this.y-this.prevY;this.delta=Math.abs(a-h),this.delta>this.weight?(this.weight+=4,this.weight>=this.delta&&(this.weight=this.delta)):(this.weight--,this.weight<=this.delta&&(this.weight=this.delta)),this.weight>100?this.weight=100:this.weight<2&&(this.weight=2),t.lineWidth=e.MathUtils.map(this.weight,2,100,this.width/4,4*this.width),t.lineTo(this.x,this.y),t.strokeStyle="rgba("+i+", "+o+", "+r+", "+s+")",t.stroke(),t.closePath(),t.beginPath(),t.moveTo(this.x,this.y)}else if("ink-osc"==this.variant)this.weight=2+Math.abs(50*Math.sin(.003*Date.now())),t.lineWidth=e.MathUtils.map(this.weight,2,52,this.width/2,2*this.width),t.lineTo(this.x,this.y),t.strokeStyle="rgba("+i+", "+o+", "+r+", "+s+")",t.stroke(),t.closePath(),t.beginPath(),t.moveTo(this.x,this.y);else if("soft"==this.variant)for(var c=e.MathUtils.dist(this.prevX,this.prevY,this.x,this.y),u=e.MathUtils.angleBtw(this.prevX,this.prevY,this.x,this.y),l=0;c>l;l++){var p=this.prevX+Math.sin(u)*l,f=this.prevY+Math.cos(u)*l,d=t.createRadialGradient(p,f,this.width/6,p,f,this.width/2);d.addColorStop(0,"rgba("+i+", "+o+", "+r+", 0.1)"),d.addColorStop(1,"rgba("+i+", "+o+", "+r+", 0)"),t.fillStyle=d,t.fillRect(p-this.width/2,f-this.width/2,this.width,this.width)}else("lines"==this.variant||"calligraphy"==this.variant)&&("lines"==this.variant&&(t.lineWidth=this.width<1?1:.05*this.width),"calligraphy"==this.variant&&(t.lineWidth=.25*this.width),t.strokeStyle="rgb("+i+", "+o+", "+r+")",t.moveTo(this.prevX,this.prevY),t.lineTo(this.x,this.y),t.stroke(),t.moveTo(this.prevX-.2*this.width,this.prevY-.2*this.width),t.lineTo(this.x-.2*this.width,this.y-.2*this.width),t.stroke(),t.moveTo(this.prevX-.1*this.width,this.prevY-.1*this.width),t.lineTo(this.x-.1*this.width,this.y-.1*this.width),t.stroke(),t.moveTo(this.prevX+.1*this.width,this.prevY+.1*this.width),t.lineTo(this.x+.1*this.width,this.y+.1*this.width),t.stroke(),t.moveTo(this.prevX+.2*this.width,this.prevY+.2*this.width),t.lineTo(this.x+.2*this.width,this.y+.2*this.width),t.stroke())}t.restore(),this.prevX=this.x,this.prevY=this.y},e.LineBrush2D}),i("BB.LeapMotion",["./BB"],function(e){"use strict";return e.LeapMotion=function(){if("undefined"==typeof Leap)throw new Error(" missing LeapMotion library ")},e.LeapMotion.prototype.canvasX=0,e.LeapMotion.prototype.canvasY=0,e.LeapMotion.prototype.grab=!1,e.LeapMotion.prototype.pinch=!1,e.LeapMotion.prototype.circle=!1,e.LeapMotion.prototype.keytap=!1,e.LeapMotion.prototype.screenTap=!1,e.LeapMotion.prototype.swipe=!1,e.LeapMotion.prototype.clockwise=!1,e.LeapMotion.prototype.GetLeapData=function(t,i,o){var n=new Leap.Controller({enableGestures:!0});n.on("frame",function(t){if(t.pointables.length>0&&i){var n=t.pointables[0],r=t.interactionBox,s=r.normalizePoint(n.stabilizedTipPosition,!0);e.LeapMotion.prototype.canvasX=canvas.width*s[0],e.LeapMotion.prototype.canvasY=canvas.height*(1-s[1])}if(0===t.hands.length&&(e.LeapMotion.prototype.grab=!1,e.LeapMotion.prototype.pinch=!1,e.LeapMotion.prototype.circle=!1,e.LeapMotion.prototype.keytap=!1,e.LeapMotion.prototype.screenTap=!1,e.LeapMotion.prototype.swipe=!1),t.hands.length>0&&o){{var a=t.hands[0];a.palmPosition}1==a.grabStrength?(e.LeapMotion.prototype.grab=!0,e.LeapMotion.prototype.pinch=!1,e.LeapMotion.prototype.circle=!1,e.LeapMotion.prototype.keytap=!1,e.LeapMotion.prototype.screenTap=!1,e.LeapMotion.prototype.swipe=!1):e.LeapMotion.prototype.grab=!1,1==a.pinchStrength?(e.LeapMotion.prototype.grab=!1,e.LeapMotion.prototype.pinch=!0,e.LeapMotion.prototype.circle=!1,e.LeapMotion.prototype.keytap=!1,e.LeapMotion.prototype.screenTap=!1,e.LeapMotion.prototype.swipe=!1):e.LeapMotion.prototype.pinch=!1}t.valid&&0===t.gestures.length&&(e.LeapMotion.prototype.circle=!1,e.LeapMotion.prototype.keytap=!1,e.LeapMotion.prototype.screenTap=!1,e.LeapMotion.prototype.swipe=!1),t.valid&&t.gestures.length>0&&t.gestures.forEach(function(i){switch(i.type){case"circle":e.LeapMotion.prototype.circle=!0;var o=i.pointableIds[0],n=t.pointable(o).direction,r=Leap.vec3.dot(n,i.normal);e.LeapMotion.prototype.clockwise=r>0?!0:!1;break;case"keyTap":e.LeapMotion.prototype.keytap=!0;break;case"screenTap":e.LeapMotion.prototype.screenTap=!0;break;case"swipe":e.LeapMotion.prototype.swipe=!0}})}),n.connect()},e.LeapMotion}),i("BB.Particle2D",["./BB","./BB.Vector2"],function(e,t){"use strict";return e.Vector2=t,e.Particle2D=function(t){var i=t&&"number"==typeof t.x?t.x:0,o=t&&"number"==typeof t.y?t.y:0;if(this.position=t&&"object"==typeof t.position&&t.position instanceof e.Vector2?t.position:new e.Vector2(i,o),"undefined"!=typeof t.velocity&&"undefined"!=typeof t.heading||"undefined"!=typeof t.velocity&&"undefined"!=typeof t.speed)throw new Error("BB.Particle2D: either use heading/speed or velocity (can't initialize with both)");if("undefined"!=typeof t.velocity&&t.velocity instanceof e.Vector2)this.velocity=t.velocity;else{if(!("undefined"==typeof t.velocity||t.velocity instanceof e.Vector2))throw new Error("BB.Particle2D: velocity must be an instance of BB.Vector2");if("undefined"!=typeof t.speed||"undefined"!=typeof t.heading){if("undefined"!=typeof t.speed&&"number"!=typeof t.speed)throw new Error("BB.Particle2D: speed must be a number");if("undefined"!=typeof t.heading&&"number"!=typeof t.heading)throw new Error("BB.Particle2D: heading must be a number in radians");if("undefined"!=typeof t.heading&&"undefined"==typeof t.speed)throw new Error("BB.Particle2D: when setting a heading, a speed parameter is also required");if("undefined"!=typeof t.speed&&"undefined"==typeof t.heading)throw new Error("BB.Particle2D: when setting a speed, a heading parameter is also required");this.velocity=new e.Vector2(0,0),this.velocity.x=Math.cos(t.heading)*t.speed,this.velocity.y=Math.sin(t.heading)*t.speed}else this.velocity=new e.Vector2(0,0)}if("undefined"!=typeof t.acceleration&&"undefined"!=typeof t.velocity||"undefined"!=typeof t.acceleration&&"undefined"!=typeof t.heading||"undefined"!=typeof t.acceleration&&"undefined"!=typeof t.speed)throw new Error("BB.Particle2D: acceleration shouldn't be initialized along with velocity or heading/speed, use one or the other");this.acceleration=t&&"object"==typeof t.acceleration&&t.acceleration instanceof e.Vector2?t.acceleration:new e.Vector2(0,0),this.mass=t&&"number"==typeof t.mass?t.mass:1,this.radius=t&&"number"==typeof t.radius?t.radius:0,this.friction=t&&"number"==typeof t.friction?t.friction:1,this.elasticity=t&&"number"==typeof t.elasticity?t.elasticity:.05,this.maxSpeed=t&&"number"==typeof t.maxSpeed?t.maxSpeed:100,this._springs=[],this._colliders=[],this._world={},this._gravitations=[]},Object.defineProperty(e.Particle2D.prototype,"heading",{get:function(){return Math.atan2(this.velocity.y,this.velocity.x)},set:function(e){this.velocity.x=Math.cos(e)*this.speed,this.velocity.y=Math.sin(e)*this.speed}}),Object.defineProperty(e.Particle2D.prototype,"speed",{get:function(){return Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y)},set:function(e){this.velocity.x=Math.cos(this.heading)*e,this.velocity.y=Math.sin(this.heading)*e}}),e.Particle2D.prototype.gravitate=function(t,i){var o;if(t instanceof Array)for(var n=0;n<t.length;n++){var r=t[n];if("undefined"==typeof r)throw new Error("BB.Particle2D: gravitate array is empty");if(r instanceof e.Particle2D)this._gravitations.push({position:r.position,mass:r.mass});else if(r instanceof e.Vector2&&"number"==typeof i)o={position:r},this._gravitations.push({position:o.position,mass:i});else{if(r instanceof e.Vector2&&"number"!=typeof i)throw new Error("BB.Particle2D: gravitate array objects are missing a mass");if(!(r instanceof e.Vector2)){if("undefined"==typeof r.x||"undefined"==typeof r.y)throw new Error("BB.Particle2D: gravitate array items should be objects with x and y properties");if("undefined"==typeof i)throw new Error("BB.Particle2D: gravitate array objects are missing a mass");o={position:{x:r.x,y:r.y}},this._gravitations.push({position:o.position,mass:i})}}}else{if("undefined"==typeof t)throw new Error("BB.Particle2D: gravitate is missing arguments");if(t instanceof e.Particle2D)this._gravitations.push({position:t.position,mass:t.mass});else if(t instanceof e.Vector2&&"number"==typeof i)o={position:t},this._gravitations.push({position:o.position,mass:i});else{if(t instanceof e.Vector2&&"number"!=typeof i)throw new Error("BB.Particle2D: gravitate's second argument requires a number ( mass )");if(!(t instanceof e.Vector2)){if("undefined"==typeof t.x||"undefined"==typeof t.y)throw new Error("BB.Particle2D: gravitate argument should be an object with an x and y property");if("undefined"==typeof i)throw new Error("BB.Particle2D: gravitate's second argument requires a number ( mass )");o={position:{x:t.x,y:t.y}},this._gravitations.push({position:o.position,mass:i})}}}},e.Particle2D.prototype.spring=function(e){if(e instanceof Array)for(var t=0;t<e.length;t++){var i=e[t];if("undefined"==typeof i)throw new Error("BB.Particle2D: spring array is empty, expecting config objects");if("object"!=typeof i||"undefined"===i.position||"undefined"==typeof i.k||"undefined"==typeof i.length)throw new Error("BB.Particle2D: spring array expecting config objects, with properies for position, length and k");if("number"!=typeof i.position.x||"number"!=typeof i.position.y)throw new Error("BB.Particle2D: spring array objects' positions should have x and y properties ( numbers )");if("number"!=typeof i.k)throw new Error("BB.Particle2D: spring array object's k properties should be numbers ( usually a float )");if("number"!=typeof i.length)throw new Error("BB.Particle2D: spring array object's length properties should be numbers ( usually a integers ");this._springs.push({position:i.position,k:i.k,length:i.length})}else{if("undefined"==typeof e)throw new Error("BB.Particle2D: spring is missing arguments");if("object"!=typeof e||"undefined"===e.position||"undefined"==typeof e.k||"undefined"==typeof e.length)throw new Error("BB.Particle2D: spring expecting a config object, with properies for position, length and k");if("number"!=typeof e.position.x||"number"!=typeof e.position.y)throw new Error("BB.Particle2D: config.position should have x and y properties ( numbers )");if("number"!=typeof e.k)throw new Error("BB.Particle2D: config.k property should be a number ( usually a float )");if("number"!=typeof e.length)throw new Error("BB.Particle2D: config.length property should be a number ( usually an integer )");this._springs.push({position:e.position,k:e.k,length:e.length})}},e.Particle2D.prototype.collide=function(e){if("undefined"==typeof e)throw new Error("BB.Particle2D: collide requires arguments to konw what to collide against");"undefined"!=typeof e.dampen&&(this._world.dampen=e.dampen),"undefined"!=typeof e.left&&(this._world.left=e.left),"undefined"!=typeof e.right&&(this._world.right=e.right),"undefined"!=typeof e.top&&(this._world.top=e.top),"undefined"!=typeof e.bottom&&(this._world.bottom=e.bottom);var t=0;if("undefined"!=typeof e.particles){if(!(e.particles instanceof Array))throw new Error("BB.Particle2D: collide: particles value expecting array of particles");for(t=0;t<e.particles.length;t++){if("undefined"==typeof e.particles[t].position.x)throw new Error("BB.Particle2D: collide: particles["+t+"] is missing a position.x");if("undefined"==typeof e.particles[t].position.y)throw new Error("BB.Particle2D: collide: particles["+t+"] is missing a position.y");if("undefined"==typeof e.particles[t].radius)throw new Error("BB.Particle2D: collide: particles["+t+"] is missing a radius");this._colliders=e.particles}}},e.Particle2D.prototype.update=function(){var t,i,o,n,r,s,a,h,c,u,l,p=0,f=new e.Vector2;for(p=0;p<this._gravitations.length;p++){var d=this._gravitations[p];t=d.position.x-this.position.x,i=d.position.y-this.position.y,h=t*t+i*i,a=Math.sqrt(h),u=d.mass/h,o=t/a*u,n=i/a*u,f.set(o,n),this.applyForce(f)}for(p=0;p<this._springs.length;p++){var y=this._springs[p];t=y.position.x-this.position.x,i=y.position.y-this.position.y,a=Math.sqrt(t*t+i*i),u=(a-y.length||0)*y.k,o=t/a*u,n=i/a*u,f.set(o,n),this.applyForce(f)}for(p=0;p<this._colliders.length;p++){var g=this._colliders[p];g!==this&&(t=g.position.x-this.position.x,i=g.position.y-this.position.y,a=Math.sqrt(t*t+i*i),c=g.radius+this.radius,c>a&&(l=Math.atan2(i,t),r=this.position.x+Math.cos(l)*c,s=this.position.y+Math.sin(l)*c,o=(r-g.position.x)*this.elasticity,n=(s-g.position.y)*this.elasticity,f.set(-o,-n),this.applyForce(f)))}"undefined"!=typeof this._world.left&&this.position.x-this.radius<this._world.left&&(this.position.x=this._world.left+this.radius,this.velocity.x=-this.velocity.x,this.velocity.x*=this._world.dampen||.7),"undefined"!=typeof this._world.right&&this.position.x+this.radius>this._world.right&&(this.position.x=this._world.right-this.radius,this.velocity.x=-this.velocity.x,this.velocity.x*=this._world.dampen||.7),"undefined"!=typeof this._world.top&&this.position.y-this.radius<this._world.top&&(this.position.y=this._world.top+this.radius,this.velocity.y=-this.velocity.y,this.velocity.y*=this._world.dampen||.7),"undefined"!=typeof this._world.bottom&&this.position.y+this.radius>this._world.bottom&&(this.position.y=this._world.bottom-this.radius,this.velocity.y=-this.velocity.y,this.velocity.y*=this._world.dampen||.7),this.velocity.multiplyScalar(this.friction),this.velocity.add(this.acceleration),this.velocity.length()>this.maxSpeed&&this.velocity.setLength(this.maxSpeed),this.position.add(this.velocity),this.acceleration.multiplyScalar(0),this._gravitations=[],this._springs=[],this._colliders=[]},e.Particle2D.prototype.applyForce=function(t){if("object"!=typeof t||!(t instanceof e.Vector2))throw new Error("BB.Particle2D.applyForce: force parameter must be present and an instance of BB.Vector2");this.acceleration.add(t.clone().divideScalar(this.mass))},e.Particle2D}),i("BB.Agent2D",["./BB","./BB.Particle2D"],function(e,t){return e.Particle2D=t,e.Agent2D=function(t){e.Particle2D.call(this,t)},e.Agent2D.prototype=Object.create(e.Particle2D.prototype),e.Agent2D.prototype.constructor=e.Agent2D,e.Agent2D.prototype.seek=function(t,i,o,n,r){t instanceof Array||(t=[t]),"number"!=typeof i&&(i=.1);for(var s=new e.Vector2,a=new e.Vector2,h=0;h<t.length;h++){if(s.subVectors(t[h],this.position),"number"==typeof o){var c=s.length();if(o>c){var u=e.MathUtils.map(c,0,o,0,this.maxSpeed);s.setLength(u)}else s.setLength(this.maxSpeed)}else s.setLength(this.maxSpeed);r===!0&&s.negate(),a.subVectors(s,this.velocity),a.length()>i&&a.setLength(i),"number"==typeof n&&a.multiplyScalar(n),this.applyForce(a)}},e.Agent2D.prototype.flee=function(e,t,i){this.seek(e,t,null,i,!0)},e.Agent2D.prototype.avoid=function(t,i,o,n){t instanceof Array||(t=[t]),"number"!=typeof i&&(i=.1),"number"!=typeof o&&(o=20);for(var r=new e.Vector2,s=new e.Vector2,a=new e.Vector2,h=0,c=0;c<t.length;c++){if(!(t[c]instanceof e.Particle2D))throw new Error("BB.Agent2D.avoid: This particle is not an instance of BB.Particle2D");var u=r.subVectors(this.position,t[c].position).length();u>0&&o>u&&(r.normalize().divideScalar(u),a.add(r),h++)}h>0&&(a.divideScalar(h),a.normalize(),a.multiplyScalar(this.maxSpeed),s.subVectors(a,this.velocity),s.length()>i&&s.setLength(i),"number"==typeof n&&s.multiplyScalar(n),this.applyForce(s))},e.Agent2D.prototype.seperate=e.Agent2D.prototype.avoid,e.Agent2D.prototype.align=function(t,i,o,n){t instanceof Array||(t=[t]),"number"!=typeof i&&(i=.1),"number"!=typeof o&&(o=50);for(var r=new e.Vector2,s=new e.Vector2,a=new e.Vector2,h=0,c=0;c<t.length;c++){if(!(t[c]instanceof e.Particle2D))throw new Error("BB.Agent2D.align: This particle is not an instance of BB.Particle2D");var u=r.subVectors(this.position,t[c].position).length();u>0&&o>u&&(a.add(t[c].velocity),h++)}h>0&&(a.divideScalar(h),a.normalize(),a.multiplyScalar(this.maxSpeed),s.subVectors(a,this.velocity),s.length()>i&&s.setLength(i),"number"==typeof n&&s.multiplyScalar(n),this.applyForce(s))},e.Agent2D.prototype.cohesion=function(t,i,o,n){t instanceof Array||(t=[t]),"number"!=typeof i&&(i=.1),"number"!=typeof o&&(o=50);for(var r=new e.Vector2,s=new e.Vector2,a=0,h=0;h<t.length;h++){if(!(t[h]instanceof e.Particle2D))throw new Error("BB.Agent2D.cohesion: This particle is not an instance of BB.Particle2D");var c=r.subVectors(this.position,t[h].position).length();c>0&&o>c&&(s.add(t[h].position),a++)}a>0&&(s.divideScalar(a),this.seek(s,i,null,n))},e.Agent2D.prototype.avoidWalls=function(t){if("number"!=typeof t.top)throw new Error("BB.Agent2D.avoidWalls: config.top must be included and a number type");if("number"!=typeof t.bottom)throw new Error("BB.Agent2D.avoidWalls: config.bottom must be included and a number type");if("number"!=typeof t.left)throw new Error("BB.Agent2D.avoidWalls: config.left must be included and a number type");if("number"!=typeof t.right)throw new Error("BB.Agent2D.avoidWalls: config.right must be included and a number type");if("number"!=typeof t.distance)throw new Error("BB.Agent2D.avoidWalls: config.distance must be included and a number type");var i=null,o=new e.Vector2,n="number"==typeof t.maxForce?t.maxForce:.1;this.position.x<t.left+t.distance?i=new e.Vector2(this.maxSpeed,this.velocity.y):this.position.x>t.right-t.distance&&(i=new e.Vector2(-this.maxSpeed,this.velocity.y)),this.position.y<t.top+t.distance?i=new e.Vector2(this.velocity.x,this.maxSpeed):this.position.y>t.bottom-t.distance&&(i=new e.Vector2(this.velocity.x,-this.maxSpeed)),null!==i&&(i.normalize().multiplyScalar(this.maxSpeed),o.subVectors(i,this.velocity),o.length()>n&&o.setLength(n),this.applyForce(o))},e.Agent2D}),i("BB.FlowField2D",["./BB","./BB.Vector2","./BB.MathUtils"],function(e,t,i){"use strict";return e.Vector2=t,e.MathUtils=i,e.FlowField2D=function(t,i,o){if("number"!=typeof i)throw new Error("BB.FlowField2D: resolution must be supplied and a number type.");if("number"!=typeof i)throw new Error("BB.FlowField2D: width must be supplied and a number type.");if("number"!=typeof o)throw new Error("BB.FlowField2D: height must be supplied and a number type.");this.width=i,this.height=o,this.rows=o/t,this.cols=i/t,this.resolution=t,this.field=[];for(var n=0;n<this.cols;n++){this.field[n]=[];for(var r=0;r<this.rows;r++)this.field[n][r]=new e.Vector2(0,0)}this._debugImage=null},e.FlowField2D.prototype.generateNoiseField=function(t,i){for(var o="number"==typeof t?t:0,n="number"==typeof i?i:.1,r=o,s=0;s<this.cols;s++){for(var a=o,h=0;h<this.rows;h++){var c=e.MathUtils.map(e.MathUtils.noise(r,a),0,1,0,2*Math.PI);this.field[s][h].set(Math.cos(c),Math.sin(c)),a+=n}r+=n}this._drawDebugImage=null},e.FlowField2D.prototype.generateRandomField=function(){for(var t=0;t<this.cols;t++)for(var i=0;i<this.rows;i++){var o=e.MathUtils.polarToCartesian(1,e.MathUtils.randomFloat(0,360));this.field[t][i].set(o[0],o[1])}this._drawDebugImage=null},e.FlowField2D.prototype.lookup=function(t,i){var o=Math.floor(e.MathUtils.clamp(t/this.resolution,0,this.cols-1)),n=Math.floor(e.MathUtils.clamp(i/this.resolution,0,this.rows-1));return this.field[o][n].clone()},e.FlowField2D.prototype.drawDebug=function(e,t,i,o,n,r){function s(e){e.save();for(var t=0;t<a.cols;t++)for(var i=0;i<a.rows;i++){e.save(),e.lineWidth=.5,e.strokeStyle="#000";var o=4;e.translate(t*a.resolution,i*a.resolution),
e.rotate(Math.atan2(a.field[t][i].y,a.field[t][i].x));var n=a.field[t][i].length()*a.resolution-2;e.moveTo(0,0),e.lineTo(n,0),e.moveTo(n,0),e.lineTo(n-o,o/2),e.moveTo(n,0),e.lineTo(n-o,-o/2),e.restore()}e.stroke(),e.restore()}var a=this;if(r===!1||null!==this._debugImage&&this._debugImageWidth===o&&this._debugImageHeight===n)r===!1?(s(e),console.log("case 2")):this._debugImage.isLoaded&&(e.drawImage(this._debugImage,t,i,o,n),console.log("case 3"));else{this._debugImage=new Image,this._debugImageWidth=o,this._debugImageHeight=n;var h=document.createElement("canvas");h.width=this.width,h.height=this.height,s(h.getContext("2d")),this._debugImage.src=h.toDataURL(),this._debugImage.onload=function(){this.isLoaded=!0},console.log("case 1")}},e.FlowField2D}),i("BB.Audio",["./BB"],function(e){"use strict";return e.Audio=function(){this.context=void 0},e.Audio.init=function(e){if("undefined"!=typeof e){this.context=[];for(var t=0;e>t;t++)window.AudioContext=window.AudioContext||window.webkitAudioContext,this.context.push(new AudioContext)}else window.AudioContext=window.AudioContext||window.webkitAudioContext,this.context=new AudioContext},e.Audio.getTime=function(e){if(this.context instanceof Array){if("undefined"==typeof e)throw new Error("BB.Audio: there is more than one context, specify the index of desired context: .getTime( 0 )");return this.context[e].currentTime}return this.context.currentTime},e.Audio}),i("BB.AudioBase",["./BB","./BB.Audio","./BB.Detect"],function(e,t,i){"use strict";return e.AudioBase=function(t){if("undefined"==typeof t&&(t={}),"undefined"==typeof e.Audio.context)throw new Error("BB Audio Modules require that you first create an AudioContext: BB.Audio.init()");if(e.Audio.context instanceof Array){if("undefined"==typeof t||"undefined"==typeof t.context)throw new Error("BB.AudioBase: BB.Audio.context is an Array, specify which { context:BB.Audio.context[?] }");this.ctx=t.context}else this.ctx=e.Audio.context;if(this.gain=this.ctx.createGain(),"undefined"!=typeof t.connect)if(t.connect instanceof e.AudioAnalyser)this.gain.connect(t.connect.node);else if(t.connect instanceof e.AudioFX||t.connect instanceof e.AFX)this.gain.connect(t.connect.input);else if(t.connect instanceof e.AudioBase)this.gain.connect(t.connect.gain);else{if(!(t.connect instanceof AudioDestinationNode||t.connect instanceof AudioNode))throw new Error("BB.AudioBase: connect property expecting an AudioNode");this.gain.connect(t.connect)}else this.gain.connect(this.ctx.destination);this._volume="undefined"!=typeof t.volume?t.volume:1,this.gain.gain.value=this._volume,this.gain.gain.name="master"},Object.defineProperty(e.AudioBase.prototype,"volume",{get:function(){return this._volume},set:function(e){if("number"!=typeof e)throw new Error("BB.AudioBase.volume: expecing a number");this.setGain(e)}}),e.AudioBase.prototype.connect=function(t,i,o){if(t instanceof e.AudioAnalyser?t=t.node:t instanceof e.AudioFX||t instanceof e.AFX?t=t.input:t instanceof e.AudioBase&&(t=t.gain),!(t instanceof AudioDestinationNode||t instanceof AudioNode))throw new Error("BB.AudioBase.connect: destination should be an instanceof AudioDestinationNode or AudioNode");if("undefined"!=typeof i&&"number"!=typeof i)throw new Error("BB.AudioBase.connect: output should be a number");if("undefined"!=typeof intput&&"number"!=typeof o)throw new Error("BB.AudioBase.connect: input should be a number");"undefined"!=typeof intput?this.gain.connect(t,i,o):"undefined"!=typeof i?this.gain.connect(t,i):this.gain.connect(t)},e.AudioBase.prototype.disconnect=function(t,i,o){if(t instanceof e.AudioAnalyser?t=t.node:t instanceof e.AudioFX||t instanceof e.AFX?t=t.input:t instanceof e.AudioBase&&(t=t.gain),"undefined"!=typeof t&&!(t instanceof AudioDestinationNode||t instanceof AudioNode))throw new Error("BB.AudioBase.disconnect: destination should be an instanceof AudioDestinationNode or AudioNode");if("undefined"!=typeof i&&"number"!=typeof i)throw new Error("BB.AudioBase.disconnect: output should be a number");if("undefined"!=typeof o&&"number"!=typeof o)throw new Error("BB.AudioBase.disconnect: input should be a number");"undefined"!=typeof o?this.gain.disconnect(t,i,o):"undefined"!=typeof i?this.gain.disconnect(t,i):"undefined"!=typeof t?this.gain.disconnect(t):this.gain.disconnect()},e.AudioBase.prototype.setGain=function(e,t){if("number"!=typeof e)throw new Error("BB.AudioBase.setGain: first argument expecting a number");if(this._volume=e,"undefined"!=typeof t){if("number"!=typeof e)throw new Error("BB.AudioBase.setGain: second argument expecting a number");this._globalGainUpdate(t)}else this._globalGainUpdate(0)},e.AudioBase.prototype._sec2tc=function(e){return 2*e/10},e.AudioBase.prototype._globalGainUpdate=function(t){"undefined"==typeof t&&(t=0),"Firefox"==e.Detect.browserInfo.name?this.gain.gain.setTargetAtTimePoly(this._volume,0,t):this.gain.gain.setTargetAtTime(this._volume,0,this._sec2tc(t))},"Firefox"==e.Detect.browserInfo.name&&(AudioParam.prototype.setTargetAtTimePoly=function(e,t,i){var o=null,n=null;t=1e3*t;var r=this;o=setTimeout(function(){if(0===i)r.value=e;else{var t=e-r.value,o=t/(60*i),s=t>=0?"up":"down";n=setInterval(function(){r.value+=2*o,"up"==s?r.value>=e&&clearInterval(n):r.value<=e&&clearInterval(n)},1e3/60)}},t)}),e.AudioBase}),i("BB.AudioStream",["./BB","./BB.AudioBase"],function(e,t){"use strict";return e.AudioStream=function(t){e.AudioBase.call(this,t),this.stream=null,this.auto="undefined"!=typeof t&&"undefined"!=typeof t.autostart?t.autostart:!1,this.auto===!0&&this.open()},e.AudioStream.prototype=Object.create(e.AudioBase.prototype),e.AudioStream.prototype.constructor=e.AudioStream,e.AudioStream.prototype.open=function(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var e=this;if(!navigator.getUserMedia)throw new Error("BB.AudioStream: getUserMedia not supported");navigator.getUserMedia({audio:!0},function(t){e.stream=t;var i=e.ctx.createMediaStreamSource(t);e.node=i,i.connect(e.gain)},function(e){throw new Error("BB.AudioStream: "+e)})},e.AudioStream.prototype.close=function(){this.stream&&(this.stream.stop(),this.stream=null)},e.AudioStream}),i("BB.AudioBufferLoader",["./BB"],function(e){"use strict";return e.AudioBufferLoader=function(t,i){if("undefined"==typeof e.Audio.context)throw new Error("BB Audio Modules require that you first create an AudioContext: BB.Audio.init()");if(e.Audio.context instanceof Array){if("undefined"==typeof t||"undefined"==typeof t.context)throw new Error("BB.AudioBufferLoader: BB.Audio.context is an Array, specify which { context:BB.Audio.context[?] }");this.ctx=t.context}else this.ctx=e.Audio.context;if(this.urls=t.paths,this.auto="undefined"!=typeof t.autoload?t.autoload:!0,this.onload=i,this._cnt=0,this.buffers=[],!t)throw new Error("BB.AudioBufferLoader: requires a config object");if(!(this.ctx instanceof AudioContext))throw new Error("BB.AudioBufferLoader: context should be an instance of AudioContext");if(!(this.urls instanceof Array))throw new Error("BB.AudioBufferLoader: paths should be an Array of paths");if("boolean"!=typeof this.auto)throw new Error("BB.AudioBufferLoader: autoload should be either true or false");this.auto===!0&&this.load()},e.AudioBufferLoader.prototype.loadbuffer=function(e,t){var i=this,o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="arraybuffer",o.onload=function(){i.ctx.decodeAudioData(o.response,function(o){if(!o)throw new Error("BB.AudioBufferLoader: decodeAudioData: could not decode: "+e);i.buffers[t]=o,++i._cnt==i.urls.length&&"undefined"!=typeof i.onload&&i.onload(i.buffers)},function(e){throw new Error("BB.AudioBufferLoader: decodeAudioData:"+e)})},o.onerror=function(){throw new Error("BB.AudioBufferLoader: XHMHttpRequest")},o.send()},e.AudioBufferLoader.prototype.load=function(){for(var e=0;e<this.urls.length;e++)this.loadbuffer(this.urls[e],e)},e.AudioBufferLoader}),i("BB.AudioSampler",["./BB","./BB.AudioBufferLoader","./BB.AudioBase"],function(e,t,i){"use strict";return e.AudioBufferLoader=t,e.AudioSampler=function(t,i){if(e.AudioBase.call(this,t),!t)throw new Error("BB.AudioSampler: requires a config object");if(this.loaded=!1,this.onload=i,this.keys=[],this.paths=[],this.buffers={},this.node=null,this.rate="undefined"!=typeof t.rate?t.rate:1,this.auto="undefined"!=typeof t.autoload?t.autoload:!0,this.loader=void 0,"boolean"!=typeof this.auto)throw new Error("BB.AudioSampler: autoload should be either true or false");for(var o in t)"context"!==o&&"autoload"!==o&&"connect"!==o&&"rate"!==o&&(this.keys.push(o),this.paths.push(t[o]));this.auto===!0&&this.load()},e.AudioSampler.prototype=Object.create(e.AudioBase.prototype),e.AudioSampler.prototype.constructor=e.AudioSampler,e.AudioSampler.prototype.load=function(){var t=this;this.loader=new e.AudioBufferLoader({context:this.ctx,autoload:this.auto,paths:this.paths},function(e){for(var i=0;i<e.length;i++)t.buffers[t.keys[i]]=e[i];t.loaded=!0,"undefined"!=typeof t.onload&&t.onload(t.buffers)})},e.AudioSampler.prototype.play=function(e,t,i,o){if(!e||this.keys.indexOf(e)<0)throw new Error("BB.AudioSampler: "+e+" was not defined in constructor");var n=this.ctx.createBufferSource();n.buffer=this.buffers[e],n.playbackRate.value=this.rate,n.connect(this.gain);var r="undefined"!=typeof t?t:0,s="undefined"!=typeof i?i:0,a="undefined"!=typeof o?o:n.buffer.duration;n.start(r,s,a),this.node=n},e.AudioSampler}),i("BB.AudioTone",["./BB","./BB.AudioBase"],function(e,t){"use strict";return e.AudioTone=function(t){e.AudioBase.call(this,t),t||(t={}),this.type=null,this._wave=null;var i=["sine","square","sawtooth","triangle","custom"];if("undefined"!=typeof t.type){if(i.indexOf(t.type)<0)throw new Error('BB.AudioTone: type should be either "sine", "square", "sawtooth", "triangle" or "custom ');if("custom"===t.type){if("undefined"==typeof t.wave)throw new Error('BB.AudioTone: additional wave property is required for "custom" type');if(t.wave instanceof Array){this.type=t.type,this._wave=t.wave;var o=new Float32Array(t.wave),n=new Float32Array(o.length);this.wavetable=this.ctx.createPeriodicWave(n,o)}else{if(!(t.wave instanceof Object))throw new Error("BB.AudioTone: wave should be instanceof Object or instanceof Array");if("undefined"==typeof t.wave.real||"undefined"==typeof t.wave.imag)throw new Error('BB.AudioTone: wave object should contain a "real" and an "imag" (Float32Array) properties');if(!(t.wave.real instanceof Float32Array&&t.wave.imag instanceof Float32Array))throw new Error("BB.AudioTone: real and imag properties should be an instanceof Float32Array");this.type=t.type,this._wave=t.wave,this.wavetable=this.ctx.createPeriodicWave(t.wave.real,t.wave.imag)}}else this.type=t.type}else this.type="sine";this.polynotes={},this.gainInterval=null,this.scales={major:[],naturalminor:[],harmonicminor:[],melodicminor:[],majorpentatonic:[],minorpentatonic:[],blues:[],minorblues:[],majorblues:[],augmented:[],diminished:[],phrygiandominant:[],dorian:[],phrygian:[],lydian:[],mixolydian:[],locrian:[],jazzmelodicminor:[],dorianb2:[],lydianaugmented:[],lydianb7:[],mixolydianb13:[],"locrian#2":[],superlocrian:[],wholehalfdiminished:[],halwholediminished:[],enigmatic:[],doubleharmonic:[],hungarianminor:[],persian:[],arabian:[],japanese:[],egyptian:[],hirajoshi:[],nickfunk1:[],nickfunk2:[]},this.chords={maj:[],min:[],dim:[],7:[],min7:[],maj7:[],sus4:[],"7sus4":[],6:[],min6:[],aug:[],"7-5":[],"7+5":[],"min7-5":[],"min/maj7":[],"maj7+5":[],"maj7-5":[],9:[],min9:[],maj9:[],"7+9":[],"7-9":[],"7+9-5":[],"6/9":[],"9+5":[],"9-5":[],"min9-5":[],11:[],min11:[],"11-9":[],13:[],min13:[],maj13:[],add9:[],minadd9:[],sus2:[],5:[]}},e.AudioTone.prototype=Object.create(e.AudioBase.prototype),e.AudioTone.prototype.constructor=e.AudioTone,Object.defineProperty(e.AudioTone.prototype,"wave",{get:function(){return this._wave},set:function(e){if("undefined"==typeof e)throw new Error("BB.AudioTone.wave: expecting a wave argument ( Array or Object )");if(e instanceof Array){this.type="custom",this._wave=e;var t=new Float32Array(e),i=new Float32Array(t.length);this.wavetable=this.ctx.createPeriodicWave(i,t)}else{if(!(e instanceof Object))throw new Error("BB.AudioTone.wave: wave should be instanceof Object or instanceof Array");if("undefined"==typeof e.real||"undefined"==typeof e.imag)throw new Error('BB.AudioTone.wave: wave object should contain a "real" and an "imag" (Float32Array) properties');if(!(e.real instanceof Float32Array&&e.imag instanceof Float32Array))throw new Error("BB.AudioTone.wave: real and imag properties should be an instanceof Float32Array");this.type="custom",this._wave=e,this.wavetable=this.ctx.createPeriodicWave(e.real,e.imag)}}}),e.AudioTone.prototype.freq=function(e,t,i){"undefined"==typeof i&&(i="equal");var o=null;if("just"===i){var n=[1,25/24,9/8,1.2,5/4,4/3,45/32,1.5,1.6,5/3,1.8,15/8];if("number"!=typeof e)throw new Error("BB.AudioTone.freq: expecting a frequency in Hz");return o=e*n[t%12],t>=12&&(o*=Math.floor(t/12)+1),Math.round(100*o)/100}if("equal"===i){if("number"!=typeof e)throw new Error("BB.AudioTone.freq: expecting a frequency in Hz");"undefined"==typeof t&&(t=0);var r=Math.pow(2,1/12);return o=e*Math.pow(r,t),Math.round(100*o)/100}throw new Error("not a scale")},e.AudioTone.prototype.note=function(e,t,i){var o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],n=o.indexOf(e);if(0>n)throw new Error('BB.AudioTone.note: expecting "C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#" or "B"');var r="number"!=typeof i?440:i,s="number"!=typeof t?0:t;return e=n+12*(s+5),r*Math.pow(2,(e-69)/12)},e.AudioTone.prototype.createScale=function(e,t,i){if(e in this.scales){var o="equal";if("undefined"!=typeof i){if("equal"!==i&&"just"!==i)throw new Error('BB.AudioTone.createScale: temperment should be either "just" or "equal"');o=i}if("string"==typeof t)t=this.note(t);else{if("number"!=typeof t)throw new Error('BB.AudioTone.createScale: expecting a frequency (number) or a note ("A","A#",etc.) as second paramter');t=t}var n;"major"==e?n=[2,2,1,2,2,2,1]:"naturalminor"==e?n=[2,1,2,2,1,2,2]:"harmonicminor"==e?n=[2,1,2,2,1,3,1]:"melodicminor"==e?n=[2,1,2,2,2,2,1]:"majorpentatonic"==e?n=[2,2,3,2,3]:"minorpentatonic"==e?n=[3,2,2,3,2]:"blues"==e?n=[3,2,1,1,3,2]:"minorblues"==e?n=[2,1,2,1,1,1,2,2]:"majorblues"==e?n=[2,1,1,1,1,1,2,1,2]:"augmented"==e?n=[2,2,2,2,2,2]:"diminished"==e?n=[2,1,2,1,2,1,2,1]:"phrygiandominant"==e?n=[1,3,1,2,1,2,2]:"dorian"==e?n=[2,1,2,2,2,1,2]:"phrygian"==e?n=[1,2,2,2,1,2,2]:"lydian"==e?n=[2,2,2,1,2,2,1]:"mixolydian"==e?n=[2,2,1,2,2,1,2]:"locrian"==e?n=[1,2,2,1,2,2,2]:"jazzmelodicminor"==e?n=[2,1,2,2,2,2,1]:"dorianb2"==e?n=[1,2,2,2,2,1,2]:"lydianaugmented"==e?n=[2,2,2,2,1,2,1]:"lydianb7"==e?n=[2,2,2,1,2,1,2]:"mixolydianb13"==e?n=[2,2,1,2,1,2,2]:"locrian#2"==e?n=[2,1,2,1,2,2,2]:"superlocrian"==e?n=[1,2,1,2,2,2,2]:"wholehalfdiminished"==e?n=[2,1,2,1,2,1,2,1]:"halwholediminished"==e?n=[1,2,1,2,1,2,1,2]:"enigmatic"==e?n=[1,3,2,2,2,1,1]:"doubleharmonic"==e?n=[1,3,1,2,1,3,1]:"hungarianminor"==e?n=[2,1,3,1,1,3,1]:"persian"==e?n=[1,3,1,1,2,3,1]:"arabian"==e?n=[2,2,1,1,2,2,2]:"japanese"==e?n=[1,4,2,1,4]:"egyptian"==e?n=[2,3,2,3,2]:"hirajoshi"==e?n=[2,1,4,1,4]:"nickfunk1"==e?n=[3,2,2,3,2,3,2]:"nickfunk2"==e&&(n=[3,2,1,1,3,2,3,2,1]),this.scales[e]=[];for(var r=[0],s=1;s<n.length+1;s++){for(var a=0,h=0;s>h;h++)a+=n[h];r.push(a)}for(var c=0;c<r.length;c++)this.scales[e].push(this.freq(t,r[c],o));return this.scales[e]}throw new Error("BB.AudioTone.createScale: '"+e+"' is not a valid scale name, choose from: "+Object.keys(this.scales))},e.AudioTone.prototype._globalGainUpdate=function(t,i){if("undefined"==typeof t&&(t=0),i){"undefined"!=typeof this.gainInterval&&(clearInterval(this.gainInterval),this.gainInterval=void 0);var o=this;this.gainInterval=setInterval(function(){var t=0,i=[];for(var n in o.polynotes)o.polynotes[n].down?t++:i.push(o.polynotes[n].gain.gain.value);if(i.length>0){var r=i.reduce(function(e,t){return e+t}),s=t+r;1>s&&(s=1),"Firefox"==e.Detect.browserInfo.name?o.gain.gain.setTargetAtTimePoly(o.volume/s,0,0):o.gain.gain.setTargetAtTime(o.volume/s,0,0)}else clearInterval(o.gainInterval),o.gainInterval=void 0},1e3/60)}else{var n=0;for(var r in this.polynotes)this.polynotes[r].down&&n++;var s=0===n?1:n;"Firefox"==e.Detect.browserInfo.name?this.gain.gain.setTargetAtTimePoly(this._volume/s,0,t):this.gain.gain.setTargetAtTime(this._volume/s,0,this._sec2tc(t))}},e.AudioTone.prototype._addPolyNote=function(e,t,i){this.polynotes[e]={down:!0,osc:t,gain:i},this._globalGainUpdate(.25)},e.AudioTone.prototype._removePolyNote=function(e){"undefined"!=typeof this.polynotes[e]&&("undefined"!=typeof this.polynotes[e].timeout&&clearTimeout(this.polynotes[e].timeout),this.polynotes[e].osc.stop(0),this.polynotes[e].gain.disconnect(),delete this.polynotes[e],this._globalGainUpdate(.25))},e.AudioTone.prototype._returnSteps=function(e){var t;return"maj"==e?t=[4,3]:"min"==e?t=[3,4]:"dim"==e?t=[3,3]:"7"==e?t=[4,3,3]:"min7"==e?t=[3,4,3]:"maj7"==e?t=[4,3,4]:"sus4"==e?t=[5,2]:"7sus4"==e?t=[5,2,3]:"6"==e?t=[4,3,2]:"min6"==e?t=[3,4,2]:"aug"==e?t=[4,4]:"7-5"==e?t=[4,2,4]:"7+5"==e?t=[4,4,2]:"min7-5"==e?t=[3,3,4]:"min/maj7"==e?t=[3,4,4]:"maj7+5"==e?t=[4,4,3]:"maj7-5"==e?t=[4,2,5]:"9"==e?t=[4,3,3,-8]:"min9"==e?t=[3,4,3,-8]:"maj9"==e?t=[4,3,4,-9]:"7+9"==e?t=[4,3,3,-7]:"7-9"==e?t=[4,3,3,-9]:"7+9-5"==e?t=[4,2,4,-7]:"6/9"==e?t=[4,3,2,-7]:"9+5"==e?t=[4,4,2,-8]:"9-5"==e?t=[4,2,4,-8]:"min9-5"==e?t=[3,3,4,-8]:"11"==e?t=[4,3,3,-8,3]:"min11"==e?t=[3,4,3,-8,3]:"11-9"==e?t=[4,3,3,-9,4]:"13"==e?t=[4,3,3,-8,3,4]:"min13"==e?t=[3,4,3,-8,3,4]:"maj13"==e?t=[4,3,4,-9,3,4]:"add9"==e?t=[4,3,-5]:"minadd9"==e?t=[3,4,-5]:"sus2"==e?t=[2,5]:"5"==e&&(t=[7]),t},e.AudioTone.prototype.noteOn=function(t,i,o,n){if("undefined"==typeof t)throw new Error("need frequency");if("undefined"!=typeof this.polynotes[t]){if(!(this.polynotes[t].gain.gain.value<.99))return;this._removePolyNote(t)}var r=this.ctx.createGain();r.connect(this.gain),r.gain.value=0,r.gain.name="note";var s=this.ctx.createOscillator();s.connect(r),s.frequency.value=t,"custom"===this.type?s.setPeriodicWave(this.wavetable):s.type=this.type,this._addPolyNote(t,s,r);var a="undefined"!=typeof n?n:this.ctx.currentTime,h="undefined"!=typeof i?i:1,c="undefined"!=typeof o?o:.05;s.start(a),"Firefox"==e.Detect.browserInfo.name?r.gain.setTargetAtTimePoly(h,0,c):r.gain.setTargetAtTime(h,0,this._sec2tc(c))},e.AudioTone.prototype.chordOn=function(e){var t=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];if("object"!=typeof e)throw new Error("BB.AudioTone.chordOn: expecting config object");var i;if("number"==typeof e.frequency)i=e.frequency;else{if(!("string"==typeof e.frequency&&t.indexOf(e.frequency)>=0))throw new Error('BB.AudioTone.chordOn: frequency paramter should either be a number or a note string ("A","A#", etc.)');i=this.note(e.frequency)}for(var o="undefined"!=typeof e.velocity?e.velocity:1,n="undefined"!=typeof e.attack?e.attack:0,r="undefined"!=typeof e.type?e.type:"maj",s="undefined"!=typeof e.tuning?e.tuning:"equal",a="undefined"!=typeof e.schedule?e.schedule:0,h=this._returnSteps(r),c=[0],u=1;u<h.length+1;u++){for(var l=0,p=0;u>p;p++)l+=h[p];c.push(l)}for(var f=0;f<c.length;f++)this.noteOn(O.freq(i,c[f],s),o,n,a)},e.AudioTone.prototype.noteOff=function(t,i){if("undefined"==typeof t)throw new Error("need frequency");if("undefined"!=typeof this.polynotes[t]){this.polynotes[t].down=!1;var o=this,n=this.ctx.currentTime,r="undefined"!=typeof i?i:0;i=n+r,this.polynotes[t].gain.gain.cancelScheduledValues(n),"Firefox"==e.Detect.browserInfo.name?this.polynotes[t].gain.gain.setTargetAtTimePoly(0,0,r):this.polynotes[t].gain.gain.setTargetAtTime(0,0,this._sec2tc(r)),this.polynotes[t].osc.stop(i),this._globalGainUpdate(this._sec2tc(r),!0),"undefined"!=typeof this.polynotes[t].timeout&&clearTimeout(this.polynotes[t].timeout),this.polynotes[t].timeout=setTimeout(function(){o._removePolyNote(t)},1e3*r)}},e.AudioTone.prototype.chordOff=function(e){var t=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];if("object"!=typeof e)throw new Error("BB.AudioTone.chordOff: expecting config object");var i;if("number"==typeof e.frequency)i=e.frequency;else{if(!("string"==typeof e.frequency&&t.indexOf(e.frequency)>=0))throw new Error('BB.AudioTone.chordOff: frequency paramter should either be a number or a note string ("A","A#", etc.)');i=this.note(e.frequency)}if("string"!=typeof e.type)throw new Error("BB.AudioTone.chordOff: expecting a type property (chord) as a string");for(var o="undefined"!=typeof e.release?e.release:0,n="undefined"!=typeof e.tuning?e.tuning:"equal",r=e.type,s=this._returnSteps(r),a=[0],h=1;h<s.length+1;h++){for(var c=0,u=0;h>u;u++)c+=s[u];a.push(c)}for(var l=0;l<a.length;l++)this.noteOff(O.freq(i,a[l],n),o)},e.AudioTone.prototype.makeNote=function(e,t,i){var o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];e||(e={});var n,r,s,a,h,c;if("object"==typeof e)n="undefined"!=typeof e.frequency?"number"==typeof e.frequency?e.frequency:this.note(e.frequency):440,r="undefined"!=typeof e.velocity?e.velocity:1,a="undefined"!=typeof e.attack?e.attack:0,h="undefined"!=typeof e.release?e.release:0,s="undefined"!=typeof e.sustain?1e3*e.sustain:250,c="undefined"!=typeof e.schedule?e.schedule:0;else{if(!("number"==typeof e||"string"==typeof e&&o.indexOf(e)>=0))throw new Error('BB.AudioTone.makeNote: first argument should either be a config object or a frequency (number) or a note, "A", "A#", etc.');if(n="number"==typeof e?e:this.note(e),r="number"==typeof t?t:1,s="number"==typeof i?1e3*i:250,a=0,h=0,c=0,"undefined"!=typeof t&&"number"!=typeof t)throw new Error("BB.AudioTone.makeNote: velocity (second param) should be a number");if("undefined"!=typeof i&&"number"!=typeof i)throw new Error("BB.AudioTone.makeNote: sustain (third param) should be a number")}"undefined"!=typeof this.polynotes[n]&&"undefined"!=typeof this.polynotes[n].durTimeout&&clearTimeout(this.polynotes[n].durTimeout),this.noteOn(n,r,a,!0,c);var u=this;this.polynotes[n].durTimeout=setTimeout(function(){u.noteOff(n,h)},s)},e.AudioTone.prototype.makeChord=function(e){var t=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];if("object"!=typeof e)throw new Error("BB.AudioTone.makeChord: expecting a config object");var i;if("number"==typeof e.frequency)i=e.frequency;else{if(!("string"==typeof e.frequency&&t.indexOf(e.frequency)>=0))throw new Error('BB.AudioTone.makeChord: frequency should either be a number or a note("A","A#",etc.)');i=this.note(e.frequency)}for(var o="undefined"!=typeof e.velocity?e.velocity:1,n="undefined"!=typeof e.attack?e.attack:0,r="undefined"!=typeof e.release?e.release:0,s="undefined"!=typeof e.sustain?e.sustain:.25,a="undefined"!=typeof e.type?e.type:"maj",h="undefined"!=typeof e.tuning?e.tuning:"equal",c="undefined"!=typeof e.schedule?e.schedule:0,u=this._returnSteps(a),l=[0],p=1;p<u.length+1;p++){for(var f=0,d=0;p>d;d++)f+=u[d];l.push(f)}for(var y=0;y<l.length;y++)this.makeNote({frequency:O.freq(i,l[y],h),velocity:o,attack:n,release:r,sustain:s,schedule:c})},e.AudioTone}),i("BB.AudioNoise",["./BB","./BB.AudioBase"],function(e,t){"use strict";return e.AudioNoise=function(t){e.AudioBase.call(this,t);var i=["white","pink","brown","perlin"];if("undefined"==typeof t)t={};else if("function"==typeof t||"string"==typeof t&&i.indexOf(t)>=0){var o=t;t={type:o}}else if("string"==typeof t&&i.indexOf(t)<0)throw new Error('BB.AudioNoise: type should be either "white","pink","brown","perlin" or be a custom function');if(this._type="undefined"!=typeof t.type?t.type:"white","string"==typeof this._type&&i.indexOf(this._type)<0)throw new Error('BB.AudioNoise: type should be either "white","pink","brown","perlin" or be a custom function');if("string"!=typeof this._type&&"function"!=typeof this._type)throw new Error('BB.AudioNoise: type should be either "white","pink","brown","perlin" or be a custom function');"function"==typeof this._type&&(this._typecallback=t.type,this._type="custom"),this.duration="undefined"!=typeof t.duration?t.duration:1,this.channels="undefined"!=typeof t.channels?t.channels:2,this.node=null,this.buffer=null,this.isPlaying=!1,this._isOn=!1,this._durTimeout=null,this._initBuffer()},e.AudioNoise.prototype=Object.create(e.AudioBase.prototype),e.AudioNoise.prototype.constructor=e.AudioNoise,Object.defineProperty(e.AudioNoise.prototype,"type",{get:function(){return this._type},set:function(e){var t=["white","pink","brown","perlin"];if("string"==typeof e&&t.indexOf(e)<0)throw new Error('BB.AudioNoise: type should be either "white","pink","brown","perlin" or be a custom function');if("string"!=typeof e&&"function"!=typeof e)throw new Error('BB.AudioNoise: type should be either "white","pink","brown","perlin" or be a custom function');if("string"==typeof e)this._type=e,this._isOn===!0?(this.noiseOff(),this._initBuffer(),this.noiseOn()):this._initBuffer();else{if("function"!=typeof e)throw new Error('BB.AudioNoise: type should be either "white","pink","brown","perlin" or be a custom function');this._type="custom",this._typecallback=e,this._isOn===!0?(this.noiseOff(),this._initBuffer(),this.noiseOn()):this._initBuffer()}}}),e.AudioNoise.prototype._initBuffer=function(){var t=this.ctx.sampleRate*this.duration;this.buffer=this.ctx.createBuffer(this.channels,t,this.ctx.sampleRate);var i,o,n,r;if("white"==this._type)for(i=0;i<this.channels;i++)for(o=this.buffer.getChannelData(i),n=0;t>n;n++)o[n]=2*Math.random()-1;else if("pink"==this._type)for(i=0;i<this.channels;i++){var s,a,h,c,u,l,p;for(s=a=h=c=u=l=p=0,o=this.buffer.getChannelData(i),n=0;t>n;n++)r=2*Math.random()-1,s=.99886*s+.0555179*r,a=.99332*a+.0750759*r,h=.969*h+.153852*r,c=.8665*c+.3104856*r,u=.55*u+.5329522*r,l=-.7616*l-.016898*r,o[n]=s+a+h+c+u+l+p+.5362*r,o[n]*=.11,p=.115926*r}else if("brown"==this._type)for(i=0;i<this.channels;i++){o=this.buffer.getChannelData(i);var f=0;for(n=0;t>n;n++)r=2*Math.random()-1,o[n]=(f+.02*r)/1.02,f=o[n],o[n]*=3.5}else if("perlin"==this._type)for(i=0;i<this.channels;i++)for(o=this.buffer.getChannelData(i),n=0;t>n;n++)o[n]=2*e.MathUtils.noise(n)-1;else"custom"==this._type&&this._typecallback()},e.AudioNoise.prototype.makeNoise=function(e,t,i){var o,n="undefined"!=typeof e?e:this.duration;"undefined"!=typeof t&&(o=this.volume,this.volume=t),this.noiseOn(i,!0),"undefined"!==this._durTimeout&&clearTimeout(this._durTimeout);var r=this;this._durTimeout=setTimeout(function(){r.noiseOff(!0),"undefined"!=typeof t&&(r.volume=o)},1e3*n)},e.AudioNoise.prototype.noiseOn=function(e,t){if(this.isPlaying===!0)throw new Error("BB.AudioNoise.noiseOn: is already on");"undefined"==typeof e&&(e=0),this.node=this.ctx.createBufferSource(),this.node.buffer=this.buffer,this.node.loop=!0,this.node.connect(this.gain),this.node.start(e),("undefined"==typeof t||t===!1)&&(this._isOn=!0),this.isPlaying=!0},e.AudioNoise.prototype.noiseOff=function(e){if(this.isPlaying===!1)throw new Error("BB.AudioNoise.noiseOn: is already off");this.node.stop(),this.isPlaying=!1,("undefined"==typeof e||e===!1)&&(this._isOn=!1)},e.AudioNoise}),i("BB.AudioSequencer",["./BB"],function(e){"use strict";return e.AudioSequencer=function(t){if(!t)throw new Error("BB.AudioSequencer: requires a config object");if("undefined"==typeof e.Audio.context)throw new Error("BB Audio Modules require that you first create an AudioContext: BB.Audio.init()");if(e.Audio.context instanceof Array){if("undefined"==typeof t||"undefined"==typeof t.context)throw new Error("BB.AudioSequencer: BB.Audio.context is an Array, specify which { context:BB.Audio.context[?] }");this.ctx=t.context}else this.ctx=e.Audio.context;if(this.tempo="undefined"!=typeof t.tempo?t.tempo:120,this.bars="undefined"!=typeof t.bars?t.bars:1,this.currentBar=0,this.isPlaying=!1,this.note=-1,this.current16thNote=0,this.scheduleAheadTime="undefined"!=typeof t.scheduleAheadTime?t.scheduleAheadTime:.1,this.nextNoteTime=0,this.noteResolution="undefined"!=typeof t.noteResolution?t.noteResolution:0,this.multitrack="undefined"!=typeof t.multitrack?t.multitrack:!0,"undefined"!=typeof t.whole){if("function"!=typeof t.whole)throw new ERROR('BB.AudioSequencer: "whole" should be a function -> whole: function(time){ ... }');this.whole=t.whole}else this.whole=void 0;if("undefined"!=typeof t.half){if("function"!=typeof t.half)throw new ERROR('BB.AudioSequencer: "half" should be a function -> half: function(time){ ... }');this.half=t.half}else this.half=void 0;if("undefined"!=typeof t.quarter){if("function"!=typeof t.quarter)throw new ERROR('BB.AudioSequencer: "quarter" should be a function -> quarter: function(time){ ... }');this.quarter=t.quarter}else this.quarter=void 0;if("undefined"!=typeof t.eighth){if("function"!=typeof t.eighth)throw new ERROR('BB.AudioSequencer: "eighth" should be a function -> eighth: function(time){ ... }');this.eighth=t.eighth}else this.eighth=void 0;if("undefined"!=typeof t.sixth){if("function"!=typeof t.sixth)throw new ERROR('BB.AudioSequencer: "sixth" should be a function -> sixth: function(time){ ... }');this.sixth=t.sixth}else this.sixth=void 0;if("undefined"!=typeof t.sixteenth){if("function"!=typeof t.sixteenth)throw new ERROR('BB.AudioSequencer: "sixteenth" should be a function -> sixteenth: function(time){ ... }');this.sixteenth=t.sixteenth}else this.sixteenth=void 0},e.AudioSequencer.prototype.toggle=function(e){this.isPlaying=!this.isPlaying,this.isPlaying&&("pause"!==e&&(this.current16thNote=0),this.nextNoteTime=this.ctx.currentTime,this.update())},e.AudioSequencer.prototype.update=function(){for(;this.nextNoteTime<this.ctx.currentTime+this.scheduleAheadTime;)this.scheduleNote(this.current16thNote,this.nextNoteTime),this.nextNote()},e.AudioSequencer.prototype.scheduleNote=function(e,t){1==this.noteResolution&&e%2||2==this.noteResolution&&e%4||(this.multitrack?(0===e&&"undefined"!=typeof this.whole&&this.whole(t),e%2===0&&"undefined"!=typeof this.half&&this.half(t),e%4===0&&"undefined"!=typeof this.quarter&&this.quarter(t),e%6===0&&"undefined"!=typeof this.sixth&&this.sixth(t),e%8===0&&"undefined"!=typeof this.eighth&&this.eighth(t),"undefined"!=typeof this.sixteenth&&this.sixteenth(t)):0===e&&"undefined"!=typeof this.whole?this.whole(t):e%2===0&&"undefined"!=typeof this.half?this.half(t):e%4===0&&"undefined"!=typeof this.quarter?this.quarter(t):e%6===0&&"undefined"!=typeof this.sixth?this.sixth(t):e%8===0&&"undefined"!=typeof this.eighth?this.eighth(t):"undefined"!=typeof this.sixteenth&&this.sixteenth(t))},e.AudioSequencer.prototype.nextNote=function(){var e=60/this.tempo;this.nextNoteTime+=.25*e,this.current16thNote++,this.note=this.current16thNote-1,16==this.current16thNote&&(this.current16thNote=0,this.currentBar++,this.currentBar==this.bars&&(this.currentBar=0))},e.AudioSequencer}),i("BB.AudioAnalyser",["./BB","./BB.AudioBase"],function(e,t){"use strict";return e.AudioAnalyser=function(t){if(e.AudioBase.call(this,t),this.node=this.ctx.createAnalyser(),this.fftSize="undefined"!=typeof t&&"undefined"!=typeof t.fftSize?t.fftSize:2048,this.smoothing="undefined"!=typeof t&&"undefined"!=typeof t.smoothing?t.smoothing:.8,this.maxDecibels="undefined"!=typeof t&&"undefined"!=typeof t.maxDecibels?t.maxDecibels:-30,this.minDecibels="undefined"!=typeof t&&"undefined"!=typeof t.minDecibels?t.minDecibels:-90,this.node.fftSize=this.fftSize,this.node.smoothingTimeConstant=this.smoothing,this.node.maxDecibels=this.maxDecibels,this.node.minDecibels=this.minDecibels,this.freqByteData=new Uint8Array(this.node.frequencyBinCount),this.freqFloatData=new Float32Array(this.node.frequencyBinCount),this.timeByteData=new Uint8Array(this.node.frequencyBinCount),this.timeFloatData=new Float32Array(this.node.frequencyBinCount),this.node.connect(this.gain),this.fftSize%2!==0||this.fftSize<32||this.fftSize>2048)throw new Error("Analyser: fftSize must be a multiple of 2 between 32 and 2048")},e.AudioAnalyser.prototype=Object.create(e.AudioBase.prototype),e.AudioAnalyser.prototype.constructor=e.AudioAnalyser,e.AudioAnalyser.prototype.getByteFrequencyData=function(){
return this.node.getByteFrequencyData(this.freqByteData),this.freqByteData},e.AudioAnalyser.prototype.getFloatFrequencyData=function(){return this.node.getFloatFrequencyData(this.freqFloatData),this.freqFloatData},e.AudioAnalyser.prototype.getByteTimeDomainData=function(){return this.node.getByteTimeDomainData(this.timeByteData),this.timeByteData},e.AudioAnalyser.prototype.getFloatTimeDomainData=function(){return this.node.getFloatTimeDomainData(this.timeFloatData),this.timeFloatData},e.AudioAnalyser.prototype.getAmplitude=function(){for(var e,t=this.getByteFrequencyData(),i=0,o=t.length,n=0;o>n;n++)i+=t[n];return e=i/o},e.AudioAnalyser.prototype.getPitch=function(){var e=this.timeFloatData.length,t=Math.floor(e/2),i=0,o=-1,n=0,r=0,s=!1,a=new Array(t);this.node.getFloatTimeDomainData(this.timeFloatData);for(var h=0;e>h;h++){var c=this.timeFloatData[h];r+=c*c}if(r=Math.sqrt(r/e),.01>r)return-1;for(var u=1,l=i;t>l;l++){for(var p=0,f=0;t>f;f++)p+=Math.abs(this.timeFloatData[f]-this.timeFloatData[f+l]);if(p=1-p/t,a[l]=p,p>.9&&p>u)s=!0,p>n&&(n=p,o=l);else if(s){var d=(a[o+1]-a[o-1])/a[o];return this.ctx.sampleRate/(o+8*d)}u=p}return n>.01?this.ctx.sampleRate/o:-1},e.AudioAnalyser.prototype._resampleBufferData=function(e,t){var i=new Float64Array(6*t),o=0,n=0,r=0,s=1e3,a=-1e3,h=0,c=e.length;for(o=0;c>o;o++)r=0|t*o/c,r*=6,h=e[o],h>0?(i[r]+=h,i[r+1]+=1):0>h&&(i[r+3]+=h,i[r+4]+=1),s>h&&(s=h),h>a&&(a=h);for(o=0,n=0;t>o;o++,n+=6)0!==i[n+1]&&(i[n]/=i[n+1]),0!==i[n+4]&&(i[n+3]/=i[n+4]);for(o=0;o<e.length;o++)r=0|t*o/e.length,r*=6,h=e[o],h>0?i[r+2]+=Math.abs(i[r]-h):0>h&&(i[r+5]+=Math.abs(i[r+3]-h));for(o=0,n=0;t>o;o++,n+=6)i[n+1]&&(i[n+2]/=i[n+1]),i[n+4]&&(i[n+5]/=i[n+4]);return i},e.AudioAnalyser.prototype.getResampledBufferData=function(e,t){if(!(e instanceof AudioBuffer))throw new Error("BB.AudioAnalyser.getResampledBufferData: first parameter expecing an AudioBuffer (object)");if("number"!=typeof t)throw new Error("BB.AudioAnalyser.getResampledBufferData: second parameter expecing number (length to resample to)");for(var i=[],o=0;o<e.numberOfChannels;o++){var n=this._resampleBufferData(e.getChannelData(o),t);i.push(n)}return i},e.AudioAnalyser}),i("BB.AudioFX",["./BB","./BB.AudioBase","./BB.AudioBufferLoader"],function(e,t,i){"use strict";return e.AudioBufferLoader=i,e.AudioFX=function(t,i){if(e.AudioBase.call(this,i),"undefined"!=typeof i&&"object"!=typeof i)throw new Error("BB.AudioFX: second parameter should be a config object");"undefined"==typeof i&&(i={});var o=["filter","reverb","delay"];if("string"!=typeof t||o.indexOf(t)<0)throw new Error('BB.AudioFX: first argument should be a type of effect ("filter", "reverb" or "delay")');if(this.type=t,"filter"===t){var n=["lowpass","highpass","bandpass","lowshelf","highshelf","peaking","notch","allpass"];if("undefined"!=typeof i.type&&n.indexOf(i.type)<0)throw new Error('BB.AudioFX: config.type must be either "lowpass", "highpass", "bandpass", "lowshelf", "highshelf", "peaking", "notch" or "allpass" ');if("undefined"!=typeof i.frequency&&"number"!=typeof i.frequency)throw new Error("BB.AudioFX: config.frequency should be a number");if("undefined"!=typeof i.fgain&&"number"!=typeof i.fgain)throw new Error("BB.AudioFX: config.fgain should be a number");if("undefined"!=typeof i.Q&&"number"!=typeof i.Q)throw new Error("BB.AudioFX: config.Q should be a number");this.node=this.ctx.createBiquadFilter(),this.node.type="undefined"!=typeof i.type?i.type:"lowpass",this.node.frequency.value="undefined"!=typeof i.frequency?i.frequency:220,this.node.gain.value="undefined"!=typeof i.fgain?i.fgain:3,this.node.Q.value="undefined"!=typeof i.Q?i.Q:8}else if("reverb"===t)if(this.node=this.ctx.createConvolver(),this.impulse={buffers:null},"undefined"!=typeof i.paths){var r=this;new e.AudioBufferLoader({paths:i.paths},function(e){r.impulse.buffers=e,r.node.buffer=r.impulse.buffers[0]})}else{var s,a,h;if("undefined"!=typeof i.duration){if("number"!=typeof i.duration)throw new Error("BB.AudioFX: reverb config.duration should be a number");s=i.duration}else s=1;if("undefined"!=typeof i.decay){if("number"!=typeof i.decay)throw new Error("BB.AudioFX: reverb config.decay should be a number");a=i.decay}else a=2;if("undefined"!=typeof i.reverse){if("boolean"!=typeof i.reverse)throw new Error("BB.AudioFX: reverb config.reverse should be a boolean");h=i.reverse}else h=!1;this.node.buffer=this._impulseResponse(s,a,h)}else if("delay"===t){if(this._max=null,this._time=null,"undefined"!=typeof i.max){if("number"!=typeof i.max)throw new Error("BB.AudioFX: config.max should be a number in seconds");this._max=i.max}else this._max=1;if(this.node=this.ctx.createDelay(this._max),"undefined"!=typeof i.time){if("number"!=typeof i.time)throw new Error("BB.AudioFX: delay.time should be a number in seconds, up to max");this._time=i.time}else this._time=1;this.node.delayTime.value=this._time}this.input=this.ctx.createGain(),this._wet=new e.AudioBase({connect:this.gain}),this._dry=new e.AudioBase({connect:this.gain}),this._dry.volume=0,this.input.connect(this._dry.gain),this.input.connect(this.node),this.node.connect(this._wet.gain)},e.AudioFX.prototype=Object.create(e.AudioBase.prototype),e.AudioFX.prototype.constructor=e.AudioFX,Object.defineProperty(e.AudioFX.prototype,"dry",{get:function(){return this._dry.volume},set:function(e){if("number"!=typeof e)throw new Error("BB.AudioFX.dry: expecing a number");this._dry.setGain(e);var t=1-e;this._wet.setGain(t)}}),Object.defineProperty(e.AudioFX.prototype,"wet",{get:function(){return this._wet.volume},set:function(e){if("number"!=typeof e)throw new Error("BB.AudioFX.wet: expecing a number");this._wet.setGain(e);var t=1-e;this._dry.setGain(t)}}),e.AudioFX.prototype.setDryGain=function(e,t){if("number"!=typeof e)throw new Error("BB.AudioFX.setDryGain: first argument expecting a number");this._dry._volume=e;var i=1-e;if(this._wet._volume=i,"undefined"!=typeof t){if("number"!=typeof e)throw new Error("BB.AudioFX.setDryGain: second argument expecting a number");this._dry._globalGainUpdate(t),this._wet._globalGainUpdate(t)}else this._dry._globalGainUpdate(0),this._wet._globalGainUpdate(0)},e.AudioFX.prototype.setWetGain=function(e,t){if("number"!=typeof e)throw new Error("BB.AudioFX.setWetGain: first argument expecting a number");this._wet._volume=e;var i=1-e;if(this._dry._volume=i,"undefined"!=typeof t){if("number"!=typeof e)throw new Error("BB.AudioFX.setWetGain: second argument expecting a number");this._wet._globalGainUpdate(t),this._dry._globalGainUpdate(t)}else this._wet._globalGainUpdate(0),this._dry._globalGainUpdate(0)},Object.defineProperty(e.AudioFX.prototype,"frequency",{get:function(){if("filter"!==this.type)throw new Error('BB.AudioFX: frequency value only availalbe when using "filter" effect');return this.node.frequency.value},set:function(e){if("filter"!==this.type)throw new Error('BB.AudioFX: frequency value only availalbe when using "filter" effect');this.node.frequency.value=e}}),Object.defineProperty(e.AudioFX.prototype,"fgain",{get:function(){if("filter"!==this.type)throw new Error('BB.AudioFX: fgain value only availalbe when using "filter" effect');return this.node.gain.value},set:function(e){if("filter"!==this.type)throw new Error('BB.AudioFX: fgain value only availalbe when using "filter" effect');this.node.gain.value=e}}),Object.defineProperty(e.AudioFX.prototype,"Q",{get:function(){if("filter"!==this.type)throw new Error('BB.AudioFX: Q property only availalbe when using "filter" effect');return this.node.Q.value},set:function(e){if("filter"!==this.type)throw new Error('BB.AudioFX: Q property only availalbe when using "filter" effect');this.node.Q.value=e}}),e.AudioFX.prototype.calcFrequencyResponse=function(e){if("filter"!==this.type)throw new Error('BB.AudioFX: calcFrequencyResponse() only works with "filter" FX type');if("number"!=typeof e)throw new Error("BB.AudioFX: expecting a length (number) argument");for(var t=11,i=new Float32Array(e),o=new Float32Array(e),n=new Float32Array(e),r=.5*this.ctx.sampleRate,s=0;e>s;++s){var a=s/e;a=r*Math.pow(2,t*(a-1)),i[s]=a}this.node.getFrequencyResponse(i,o,n);var h={frequency:i,magResponse:o,phaseResponse:n};return h},e.AudioFX.prototype.useImpulse=function(e){if(isNaN(e)||-1!==e.toString().indexOf("."))throw new Error("BB.AudioFX.useImpulse: expecting an integer");if(e>=this.impulse.buffers.length)throw new Error("BB.AudioFX.useImpulse: the value cannot be larger than "+(this.impulse.buffers.length-1)+", the length of impulse.buffers");this.node.buffer=this.impulse.buffers[e]},e.AudioFX.prototype._impulseResponse=function(e,t,i){for(var o=this.ctx.sampleRate,n=o*e,r=this.ctx.createBuffer(2,n,o),s=r.getChannelData(0),a=r.getChannelData(1),h=0;n>h;h++){var c=i?n-h:h;s[h]=(2*Math.random()-1)*Math.pow(1-c/n,t),a[h]=(2*Math.random()-1)*Math.pow(1-c/n,t)}return r},Object.defineProperty(e.AudioFX.prototype,"time",{get:function(){return this._time},set:function(e){if("number"!=typeof e)throw new Error("BB.AudioFX.time: expecing a number in seconds (up to max value)");this._time=e,this.node.delayTime.value=this._time}}),e.AudioFX}),i("BB.AFX",["./BB","./BB.AudioBase"],function(e,t){"use strict";return e.AFX=function(t){if(e.AudioBase.call(this,t),"undefined"!=typeof t&&"object"!=typeof t)throw new Error("BB.AFX: first parameter should be a config object");"undefined"==typeof t&&(t={}),this.node=null},e.AFX.prototype=Object.create(e.AudioBase.prototype),e.AFX.prototype.constructor=e.AFX,e.AFX.prototype._init=function(){this.input=this.ctx.createGain(),this._wet=new e.AudioBase({connect:this.gain}),this._dry=new e.AudioBase({connect:this.gain}),this._dry.volume=0,this.input.connect(this._dry.gain),this.input.connect(this.node),this.node.connect(this._wet.gain)},Object.defineProperty(e.AFX.prototype,"dry",{get:function(){return this._dry.volume},set:function(e){if("number"!=typeof e)throw new Error("BB.AFX.dry: expecing a number");this._dry.setGain(e);var t=1-e;this._wet.setGain(t)}}),Object.defineProperty(e.AFX.prototype,"wet",{get:function(){return this._wet.volume},set:function(e){if("number"!=typeof e)throw new Error("BB.AFX.wet: expecing a number");this._wet.setGain(e);var t=1-e;this._dry.setGain(t)}}),e.AFX.prototype.setDryGain=function(e,t){if("number"!=typeof e)throw new Error("BB.AFX.setDryGain: first argument expecting a number");this._dry._volume=e;var i=1-e;if(this._wet._volume=i,"undefined"!=typeof t){if("number"!=typeof e)throw new Error("BB.AFX.setDryGain: second argument expecting a number");this._dry._globalGainUpdate(t),this._wet._globalGainUpdate(t)}else this._dry._globalGainUpdate(0),this._wet._globalGainUpdate(0)},e.AFX.prototype.setWetGain=function(e,t){if("number"!=typeof e)throw new Error("BB.AFX.setWetGain: first argument expecting a number");this._wet._volume=e;var i=1-e;if(this._dry._volume=i,"undefined"!=typeof t){if("number"!=typeof e)throw new Error("BB.AFX.setWetGain: second argument expecting a number");this._wet._globalGainUpdate(t),this._dry._globalGainUpdate(t)}else this._wet._globalGainUpdate(0),this._dry._globalGainUpdate(0)},e.AFX}),i("BB.BaseMidiInput",["./BB"],function(e){"use strict";return e.BaseMidiInput=function(e){if(this.channel=null,this.command=null,this.type=null,this.velocity=null,"number"==typeof e)this.note=e;else{if("object"!=typeof e)throw new Error("BB.BaseMidiInput: config parameter must be a number or object type");"number"==typeof e.channel&&(this.channel=e.channel),"number"==typeof e.command&&(this.command=e.command),"number"==typeof e.type&&(this.type=e.type),"number"==typeof e.velocity&&(this.velocity=e.velocity)}this.inputType="base",this.eventStack={change:[]}},e.BaseMidiInput.prototype.on=function(e,t){"change"===e&&this.eventStack.change.push(t)},e.BaseMidiInput}),i("BB.MidiInputButton",["./BB","./BB.BaseMidiInput"],function(e,t){"use strict";return e.BaseMidiInput=t,e.MidiInputButton=function(e){t.call(this,e),this.inputType="button",this.eventStack.down=[],this.eventStack.up=[]},e.MidiInputButton.prototype=Object.create(t.prototype),e.MidiInputButton.prototype.constructor=t,e.MidiInputButton.prototype.on=function(e,i){t.prototype.on.call(this,e,i),"down"===e?this.eventStack.down.push(i):"up"===e&&this.eventStack.up.push(i)},e.MidiInputButton}),i("BB.MidiInputKey",["./BB","./BB.BaseMidiInput"],function(e,t){"use strict";return e.BaseMidiInput=t,e.MidiInputKey=function(e){t.call(this,e),this.inputType="key"},e.MidiInputKey.prototype=Object.create(t.prototype),e.MidiInputKey.prototype.constructor=t,e.MidiInputKey}),i("BB.MidiInputKnob",["./BB","./BB.BaseMidiInput"],function(e,t){"use strict";return e.BaseMidiInput=t,e.MidiInputKnob=function(e){t.call(this,e),this.inputType="knob",this.eventStack.max=[],this.eventStack.min=[]},e.MidiInputKnob.prototype=Object.create(t.prototype),e.MidiInputKnob.prototype.constructor=t,e.MidiInputKnob.prototype.on=function(e,i){t.prototype.on.call(this,e,i),"min"===e?this.eventStack.min.push(i):"max"===e&&this.eventStack.max.push(i)},e.MidiInputKnob}),i("BB.MidiInputPad",["./BB","./BB.BaseMidiInput"],function(e,t){"use strict";return e.BaseMidiInput=t,e.MidiInputPad=function(e){t.call(this,e),this.inputType="pad"},e.MidiInputPad.prototype=Object.create(t.prototype),e.MidiInputPad.prototype.constructor=t,e.MidiInputPad}),i("BB.MidiInputSlider",["./BB","./BB.BaseMidiInput"],function(e,t){"use strict";return e.BaseMidiInput=t,e.MidiInputSlider=function(e){t.call(this,e),this.inputType="slider",this.eventStack.max=[],this.eventStack.min=[]},e.MidiInputSlider.prototype=Object.create(t.prototype),e.MidiInputSlider.prototype.constructor=t,e.MidiInputSlider.prototype.on=function(e,i){t.prototype.on.call(this,e,i),"min"===e?this.eventStack.min.push(i):"max"===e&&this.eventStack.max.push(i)},e.MidiInputSlider}),i("BB.MidiDevice",["./BB","./BB.BaseMidiInput","./BB.MidiInputButton","./BB.MidiInputKey","./BB.MidiInputKnob","./BB.MidiInputPad","./BB.MidiInputSlider"],function(e,t,i,o,n,r,s){"use strict";function a(){this.eventStack={noteOn:[],noteOff:[]}}return e.BaseMidiInput=t,e.MidiInputButton=i,e.MidiInputKey=o,e.MidiInputKnob=n,e.MidiInputPad=r,e.MidiInputSlider=s,e.MidiDevice=function(t,i,o){function n(e){h.midiAccess=e;for(var t=h.midiAccess.inputs.values(),o=t.next();o&&!o.done;o=t.next())o.value.onmidimessage=s;h.midiAccess.onstatechange=r,i(e)}function r(e){var t=e.port,i=t.state,o=t.name,n=t.type;"connected"===i&&h._connectEvent?h._connectEvent(o,n,t):"disconnected"===i&&h._disconnectEvent&&h._disconnectEvent(o,n,t)}function s(e){var t=e.data,i=t[0]>>4,o=15&t[0],n=240&t[0],r=t[1],s=t[2];h._messageEvent&&h._messageEvent({command:i,channel:o,type:n,note:r,velocity:s},e);var a=0,u="key"+r;if(u in c){var l=null,p=null;for(a=0;a<c[u].length;a++)c[u][a][0].command===i&&c[u][a][0].channel===o&&(l=c[u][a][0],p=c[u][a][1]);null===l&&(l=c[u][0][0],p=c[u][0][1]),l.command=i,l.channel=o,l.type=n,l.velocity=s;var f=l.eventStack.change,d={};for(a=0;a<f.length;a++)d={velocity:s,channel:o,command:i,type:n,note:r},f[a](d,l.inputType,p);if("slider"==l.inputType||"knob"==l.inputType)if(127==s){var y=l.eventStack.max;for(a=0;a<y.length;a++)d={velocity:s,channel:o,command:i,type:n,note:r},y[a](d,l.inputType,p)}else if(0===s){var g=l.eventStack.min;for(a=0;a<g.length;a++)d={velocity:s,channel:o,command:i,type:n,note:r},g[a](d,l.inputType,p)}if("button"==l.inputType)if(127==s){var m=l.eventStack.down;for(a=0;a<m.length;a++)d={velocity:s,channel:o,command:i,type:n,note:r},m[a](d,l.inputType,p)}else if(0===s){var B=l.eventStack.up;for(a=0;a<B.length;a++)d={velocity:s,channel:o,command:i,type:n,note:r},B[a](d,l.inputType,p)}}var w=["C1","C#1","D1","D#1","E1","F1","F#1","G1","G#1","A1","A#1","B1","C2","C#2","D2","D#2","E2","F2","F#2","G2","G#2","A2","A#2","B2","C3","C#3","D3","D#3","E3","F3","F#3","G3","G#3","A3","A#3","B3","C4","C#4","D4","D#4","E4","F4","F#4","G4","G#4","A4","A#4","B4","C5","C#5","D5","D#5","E5","F5","F#5","G5","G#5","A5","A#5","B5","C6","C#6","D6","D#6","E6","F6","F#6","G6","G#6","A6","A#6","B6","C7","C#7","D7","D#7","E7","F7","F#7","G7","G#7","A7","A#7","B7","C8","C#8","D8","D#8","E8","F8","F#8","G8","G#8","A8","A#8","B8","C9","C#9","D9","D#9","E9","F9","F#9","G9","G#9","A9","A#9","B9","C10","C#10","D10","D#10","E10","F10","F#10","G10","G#10","A10","A#10","B10"];if(a=0,144===n&&r>-1&&121>r&&h.keyboard.eventStack.noteOn.length>0)for(;a<h.keyboard.eventStack.noteOn.length;a++)h.keyboard.eventStack.noteOn[a](w[r],{velocity:s,channel:o,command:i,type:n,note:r});else if(128===n&&r>-1&&121>r&&h.keyboard.eventStack.noteOff.length>0)for(;a<h.keyboard.eventStack.noteOff.length;a++)h.keyboard.eventStack.noteOff[a](w[r],{velocity:s,channel:o,command:i,type:n,note:r})}if("object"!=typeof t)throw new Error("BB.MidiDevice: midiMap parameter must be an object");if("function"!=typeof i)throw new Error("BB.MidiDevice: success parameter must be a function");if("function"!=typeof o)throw new Error("BB.MidiDevice: failure parameter must be a function");var h=this;this.inputs={sliders:[],knobs:[],buttons:[],pads:[],keys:[]},this.keyboard=new a,this.midiAccess=null,this._connectEvent=null,this._disconnectEvent=null,this._messageEvent=null;var c={},u=null,l=0,p=null,f=null;if("undefined"!=typeof t.sliders&&t.sliders instanceof Array)for(l=0;l<t.sliders.length;l++)u=new e.MidiInputSlider(t.sliders[l]),f="number"==typeof t.sliders[l]?t.sliders[l]:t.sliders[l].note,p="key"+f,"undefined"==typeof c[p]&&(c[p]=[]),c[p].push([u,l]),h.inputs.sliders.push(u);if("undefined"!=typeof t.knobs&&t.knobs instanceof Array)for(l=0;l<t.knobs.length;l++)u=new e.MidiInputKnob(t.knobs[l]),f="number"==typeof t.knobs[l]?t.knobs[l]:t.knobs[l].note,p="key"+f,"undefined"==typeof c[p]&&(c[p]=[]),c[p].push([u,l]),h.inputs.knobs.push(u);if("undefined"!=typeof t.buttons&&t.buttons instanceof Array)for(l=0;l<t.buttons.length;l++)u=new e.MidiInputButton(t.buttons[l]),f="number"==typeof t.buttons[l]?t.buttons[l]:t.buttons[l].note,p="key"+f,"undefined"==typeof c[p]&&(c[p]=[]),c[p].push([u,l]),h.inputs.buttons.push(u);if("undefined"!=typeof t.pads&&t.pads instanceof Array)for(l=0;l<t.pads.length;l++)u=new e.MidiInputPad(t.pads[l]),f="number"==typeof t.pads[l]?t.pads[l]:t.pads[l].note,p="key"+f,"undefined"==typeof c[p]&&(c[p]=[]),c[p].push([u,l]),h.inputs.pads.push(u);if("undefined"!=typeof t.keys&&t.keys instanceof Array)for(l=0;l<t.keys.length;l++)u=new e.MidiInputKey(t.keys[l]),f="number"==typeof t.keys[l]?t.keys[l]:t.keys[l].note,p="key"+f,"undefined"==typeof c[p]&&(c[p]=[]),c[p].push([u,l]),h.inputs.keys.push(u);navigator.requestMIDIAccess?navigator.requestMIDIAccess({sysex:!1}).then(n,o):o()},e.MidiDevice.prototype.on=function(e,t){if("string"!=typeof e)throw new Error("BB.MidiDevice.on: name parameter must be a string type");if("function"!=typeof t)throw new Error("BB.MidiDevice.on: callback parameter must be a function type");if("connect"===e)this._connectEvent=t;else if("disconnect"===e)this._disconnectEvent=t;else{if("message"!==e)throw new Error("BB.MidiDevice.on: "+e+" is not a valid event name");this._messageEvent=t}},a.prototype.on=function(e,t){"noteOn"===e?this.eventStack.noteOn.push(t):"noteOff"===e&&this.eventStack.noteOff.push(t)},e.MidiDevice}),i("main",["require","BB","BB.MathUtils","BB.Detect","BB.Color","BB.BaseBrush2D","BB.ImageBrush2D","BB.LineBrush2D","BB.BrushManager2D","BB.MouseInput","BB.Pointer","BB.LeapMotion","BB.Vector2","BB.Particle2D","BB.Agent2D","BB.FlowField2D","BB.Audio","BB.AudioBase","BB.AudioStream","BB.AudioBufferLoader","BB.AudioSampler","BB.AudioTone","BB.AudioNoise","BB.AudioSequencer","BB.AudioAnalyser","BB.AudioFX","BB.AFX","BB.MidiDevice","BB.BaseMidiInput","BB.MidiInputKnob","BB.MidiInputSlider","BB.MidiInputButton","BB.MidiInputKey","BB.MidiInputPad"],function(e){"use strict";var t=e("BB");return t.MathUtils=e("BB.MathUtils"),t.Detect=e("BB.Detect"),t.Color=e("BB.Color"),t.BaseBrush2D=e("BB.BaseBrush2D"),t.ImageBrush2D=e("BB.ImageBrush2D"),t.LineBrush2D=e("BB.LineBrush2D"),t.BrushManager2D=e("BB.BrushManager2D"),t.MouseInput=e("BB.MouseInput"),t.Pointer=e("BB.Pointer"),t.LeapMotion=e("BB.LeapMotion"),t.Vector2=e("BB.Vector2"),t.Particle2D=e("BB.Particle2D"),t.Agent2D=e("BB.Agent2D"),t.FlowField2D=e("BB.FlowField2D"),t.Audio=e("BB.Audio"),t.AudioBase=e("BB.AudioBase"),t.AudioStream=e("BB.AudioStream"),t.AudioBufferLoader=e("BB.AudioBufferLoader"),t.AudioSampler=e("BB.AudioSampler"),t.AudioTone=e("BB.AudioTone"),t.AudioNoise=e("BB.AudioNoise"),t.AudioSequencer=e("BB.AudioSequencer"),t.AudioAnalyser=e("BB.AudioAnalyser"),t.AudioFX=e("BB.AudioFX"),t.AFX=e("BB.AFX"),t.MidiDevice=e("BB.MidiDevice"),t.BaseMidiInput=e("BB.BaseMidiInput"),t.MidiInputKnob=e("BB.MidiInputKnob"),t.MidiInputSlider=e("BB.MidiInputSlider"),t.MidiInputButton=e("BB.MidiInputButton"),t.MidiInputKey=e("BB.MidiInputKey"),t.MidiInputPad=e("BB.MidiInputPad"),t}),t("main")});